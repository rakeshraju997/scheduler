{"version":3,"sources":["../../lib/assets/javascripts/os-time.js","../../lib/assets/javascripts/os-shared.js","../../lib/assets/javascripts/os-notifications.js","../../lib/assets/javascripts/os-actions.js","../../lib/assets/javascripts/main_front.js"],"names":["latepoint_is_timeframe_in_periods","timeframe_start","timeframe_end","periods_arr","is_inside","arguments","length","undefined","i","period_start","period_end","buffer_before","buffer_after","period_info","split","parseFloat","latepoint_is_period_inside_another","latepoint_is_period_overlapping","period_one_start","period_one_end","period_two_start","period_two_end","latepoint_minutes_to_hours_preferably","time","army_clock","latepoint_is_army_clock","hours","Math","floor","minutes","latepoint_minutes_to_hours","latepoint_am_or_pm","latepoint_hours_and_minutes_to_minutes","hours_and_minutes","ampm","hours_and_minutes_arr","parseInt","latepoint_get_time_system","latepoint_helper","time_system","latepoint_minutes_to_hours_and_minutes","format","sprintf","latepoint_mask_timefield","$elem","jQuery","inputmask","mask","placeholder","latepoint_mask_phone","latepoint_is_phone_masking_enabled","latepoint_get_phone_format","phone_format","enable_phone_masking","latepoint_show_booking_end_time","show_booking_end_time","latepoint_init_form_masks","latepoint_get_paypal_payment_amount","$booking_form_element","payment_portion","payment_amount","find","val","data","latepoint_add_notification","message","message_type","wrapper","append","remove","latepoint_generate_form_message_html","messages","status","message_html","Array","isArray","forEach","latepoint_clear_form_messages","$form","latepoint_show_data_in_lightbox","extra_classes","lightbox_css_classes","addClass","latepoint_init_payment_method_actions","payment_method","_jQuery","callbacks_list","is_last_step","trigger","removeClass","when","apply","_toConsumableArray","map","callback","action","done","show","latepoint_show_next_btn","clear_step_services","latepoint_update_summary_field","clear_sub_step_attendies","clear_sub_step_duration","clear_step_service_extras","clear_step_locations","clear_step_agents","clear_step_datepicker","latepoint_hide_next_btn","latepoint_show_prev_btn","latepoint_hide_prev_btn","latepoint_show_capacity_selector","$item","closest","max_capacity","min_capacity","text","latepoint_show_durations","latepoint_apply_coupon","$coupon_input","form_params","serialize","route_name","params","layout","return_format","ajax","type","dataType","url","ajaxurl","success","latepoint_show_message_inside_element","latepoint_reload_step","latepoint_remove_coupon","fadeOut","step_name","index","className","match","join","nextAll","submit","latepoint_get_payment_sub_step","current_sub_step","prev","offset","payment_sub_steps","push","selected_payment_method","indexOf","sub_step","latepoint_reset_password_from_booking_init","hide","on","html","field_name","value","$summary_holder","String","trim","hasClass","slideDown","fadeIn","slideUp","latepoint_password_changed_show_login","response","latepoint_hide_message_inside_element","prepend","latepoint_add_action","priority","sort","a","b","document","ready","$","e","$this","this","confirm","location","reload","window","replace","before","after","func_name","alert","preventDefault","form_data","record_id","documentElement","body","animate","scrollTop","top","form_values_to_update","each","name","latepoint_init_step","latepoint_init_step_selectable_items","latepoint_init_step_datepicker","latepoint_init_step_contact","latepoint_init_step_agents","latepoint_init_step_services","latepoint_init_step_payment","latepoint_init_step_verify","latepoint_init_step_confirmation","day_timeslots","$day","service_duration","interval","work_start_minutes","work_end_minutes","total_work_minutes","available_minutes","attr","toString","Number","day_minutes","$timeslots","prev_minutes","current_minutes","timeslot_class","time_pick_style","off_label","off_width","includes","tick_html","timeslot_label","end_minutes","end_minutes_ampm","msg_not_available","$scrollable_wrapper","stop","scrollHeight","os_init_timeslots","selected_timeslot_time","os_init_monthly_calendar_navigation","next_month_route_name","next","latepoint_calendar_set_month_label","$btn","$calendar_element","last","calendar_year","calendar_month","booking_info","target_date_string","location_id","agent_id","service_id","duration","total_attendies","latepoint_calendar_show_or_hide_prev_next_buttons","latepoint_format_minutes_to_time","formatted_time","latepoint_format_price","toFixed","which","focus","$payment_step","portion","off","latepoint_selectable_item_clicked","latepoint_selectable_item_quantity_keyup","latepoint_calculate_total_price","$booking_form","calculate_price_route","price","latepoint_update_quantity_for_selectable_items","ids","get","event","new_value","max_quantity","stopPropagation","stopImmediatePropagation","target","current_value","summary_value","latepoint_trigger_next_btn","currency_symbol_before","currency_symbol_after","min","max","add_value","$category_wrapper","$main_parent","parent","latepoint_init_step_locations","account_nonse","password","password_confirmation","param","latepoint_init_customer_dashboard_login","$login_form_wrapper","FB","login","authResponse","token","accessToken","latepoint_step_content_change_start","latepoint_step_content_change_end","scope","gapi","googleUser","$login_form_wrappers","load","auth2","init","client_id","cookiepolicy","attachClickHandler","getAuthResponse","id_token","error","get_customer_name","$wrapper","customer_name","first_name","last_name","latepoint_init_facebook_login","latepoint_init_google_login","latepoint_validate_fields","email","new_content","replaceWith","setTimeout","$booking_form_elements","latepoint_change_step_desc","$step_progress","prevAll","side_panel_desc","top_header_desc","latepoint_progress_prev","latepoint_progress_next","latepoint_next_step_description","latepoint_prev_step_description","$fields","is_valid","latepoint_submit_booking_form","is_pre_last_step","css","show_next_btn","show_prev_btn","send_to_step","latepoint_init_booking_form","_jQuery2","current_step","is_final_submit","direction","fail","$select_box","timezone_name","is_timezone_selected","tzid","Intl","DateTimeFormat","resolvedOptions","timeZone","change","_jQuery3","$next_btn","new_sub_step","$services_step","parents","$current_active_step","$back_btn","$new_current_step","new_current_step_name","cancel_booking_prompt","$booking_box","route","id","$tabs_wrapper","booking_button_route","restrictions","show_service_categories","show_locations","show_services","show_agents","selected_location","selected_agent","selected_service","selected_service_category","selected_start_date","selected_start_time","calendar_start_date","isEmptyObject","lightbox_class","step"],"mappings":"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","sourcesContent":["function latepoint_is_timeframe_in_periods(timeframe_start, timeframe_end, periods_arr) {\n  var is_inside = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n  for (var i = 0; i < periods_arr.length; i++) {\n\n    var period_start = 0;\n    var period_end = 0;\n    var buffer_before = 0;\n    var buffer_after = 0;\n\n    var period_info = periods_arr[i].split(':');\n    if (period_info.length == 2) {\n      period_start = period_info[0];\n      period_end = period_info[1];\n    } else {\n      buffer_before = period_info[2];\n      buffer_after = period_info[3];\n      period_start = parseFloat(period_info[0]) - parseFloat(buffer_before);\n      period_end = parseFloat(period_info[1]) + parseFloat(buffer_after);\n    }\n    if (is_inside) {\n      if (latepoint_is_period_inside_another(timeframe_start, timeframe_end, period_start, period_end)) {\n        return true;\n      }\n    } else {\n      if (latepoint_is_period_overlapping(timeframe_start, timeframe_end, period_start, period_end)) {\n        return true;\n      }\n    }\n  };\n  return false;\n}\n\nfunction latepoint_is_period_overlapping(period_one_start, period_one_end, period_two_start, period_two_end) {\n  // https://stackoverflow.com/questions/325933/determine-whether-two-date-ranges-overlap/\n  return period_one_start < period_two_end && period_two_start < period_one_end;\n}\nfunction latepoint_is_period_inside_another(period_one_start, period_one_end, period_two_start, period_two_end) {\n  return period_one_start >= period_two_start && period_one_end <= period_two_end;\n}\n\n\n// Converts time in minutes to hours if possible, if minutes also exists - shows minutes too\nfunction latepoint_minutes_to_hours_preferably(time) {\n  var army_clock = latepoint_is_army_clock();\n\n  var hours = Math.floor(time / 60);\n  if (!army_clock && hours > 12) hours = hours - 12;\n\n  var minutes = time % 60;\n  if(minutes > 0) hours = hours + ':' + minutes;\n  return hours;\n}\n\n\nfunction latepoint_minutes_to_hours(time) {\n  var army_clock = latepoint_is_army_clock();\n\n  var hours = Math.floor(time / 60);\n  if (!army_clock && hours > 12) hours = hours - 12;\n  return hours;\n}\n\n\nfunction latepoint_am_or_pm(minutes) {\n  if(latepoint_is_army_clock()) return '';\n  return (minutes < 720) ? 'am' : 'pm';\n}\n\nfunction latepoint_hours_and_minutes_to_minutes(hours_and_minutes, ampm) {\n  var hours_and_minutes_arr = hours_and_minutes.split(':');\n  var hours = hours_and_minutes_arr[0];\n  var minutes = hours_and_minutes_arr[1];\n  if(ampm == \"pm\" && hours<12) hours = parseInt(hours)+12;\n  if(ampm == \"am\" && hours==12) hours = 0;\n  minutes = parseInt(minutes) + (hours * 60);\n  return minutes;\n}\n\nfunction latepoint_get_time_system(){\n  return latepoint_helper.time_system;\n}\n\nfunction latepoint_is_army_clock(){\n  return (latepoint_get_time_system() == '24');\n}\n\nfunction latepoint_minutes_to_hours_and_minutes(time) {\n  var army_clock = latepoint_is_army_clock();\n  var format = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '%02d:%02d';\n\n  var hours = Math.floor(time / 60);\n  if(!army_clock && (hours > 12)) hours = hours - 12;\n  var minutes = time % 60;\n  return sprintf(format, hours, minutes);\n}\n","function latepoint_mask_timefield($elem){\n\tif(jQuery().inputmask){\n\t  $elem.inputmask({\n\t      'mask': '99:99',\n\t      'placeholder': 'HH:MM'\n\t  });\n\t}\n}\n\nfunction latepoint_mask_phone($elem){\n\tif(latepoint_is_phone_masking_enabled() && jQuery().inputmask) $elem.inputmask(latepoint_get_phone_format());\n}\n\n\nfunction latepoint_get_phone_format(){\n  return latepoint_helper.phone_format;\n}\n\nfunction latepoint_is_phone_masking_enabled(){\n\treturn (latepoint_helper.enable_phone_masking == 'yes');\n}\n\nfunction latepoint_show_booking_end_time(){\n\treturn (latepoint_helper.show_booking_end_time == 'yes');\n}\n\nfunction latepoint_init_form_masks(){\n\tif(latepoint_is_phone_masking_enabled()) latepoint_mask_phone(jQuery('.os-mask-phone'));\n}\n\nfunction latepoint_get_paypal_payment_amount($booking_form_element){\n\tvar payment_portion = $booking_form_element.find('input[name=\"booking[payment_portion]\"]').val();\n\tvar payment_amount = (payment_portion == 'deposit') ? $booking_form_element.find('.lp-paypal-btn-trigger').data('deposit-amount') : $booking_form_element.find('.lp-paypal-btn-trigger').data('full-amount');\n\treturn payment_amount;\n}","function latepoint_add_notification(message, message_type = 'success'){\n\tvar wrapper = jQuery('body').find('.os-notifications');\n\tif(!wrapper.length){\n\t\tjQuery('body').append('<div class=\"os-notifications\"></div>');\n\t\twrapper = jQuery('body').find('.os-notifications');\n\t}\n\tif(wrapper.find('.item').length > 0) wrapper.find('.item:first-child').remove();\n\twrapper.append('<div class=\"item item-type-'+ message_type +'\">' + message + '<span class=\"os-notification-close\"><i class=\"latepoint-icon latepoint-icon-x\"></i></span></div>');\n}","function latepoint_generate_form_message_html(messages, status){\n  var message_html = '<div class=\"os-form-message-w status-' + status + '\"><ul>';\n  if(Array.isArray(messages)){\n    messages.forEach(function(message){\n      message_html+= '<li>' + message + '</li>';\n    });\n  }else{\n    message_html+= '<li>' + messages + '</li>';\n  }\n  message_html+= '</ul></div>';\n  return message_html;\n}\n\nfunction latepoint_clear_form_messages($form){\n  $form.find('.os-form-message-w').remove();\n}\n\nfunction latepoint_show_data_in_lightbox(message, extra_classes = ''){\n  jQuery('.latepoint-lightbox-w').remove();\n  var lightbox_css_classes = 'latepoint-lightbox-w latepoint-w ';\n  if(extra_classes) lightbox_css_classes+= extra_classes;\n  jQuery('body').append('<div class=\"'+ lightbox_css_classes +'\"><div class=\"latepoint-lightbox-i\">' + message + '<a href=\"#\" class=\"latepoint-lightbox-close\"><i class=\"latepoint-icon latepoint-icon-x\"></i></a></div><div class=\"latepoint-lightbox-shadow\"></div></div>');\n  jQuery('body').addClass('latepoint-lightbox-active');\n}\n\n\n\n// DOCUMENT READY\njQuery(document).ready(function( $ ) {\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  /* \n    Ajax buttons action\n  */\n  $('.latepoint').on('click', 'button[data-os-action], a[data-os-action], div[data-os-action], span[data-os-action]', function(e){\n    var $this = $(this);\n    if($this.data('os-prompt') && !confirm($this.data('os-prompt'))) return false;\n    var params = $(this).data('os-params');\n    if($(this).data('os-source-of-params')){\n      params = $($(this).data('os-source-of-params')).find('select, input, textarea').serialize();\n    }\n    var return_format = $this.data('os-return-format') ? $this.data('os-return-format') : 'json'\n    var data = { action: 'latepoint_route_call', route_name: $(this).data('os-action'), params: params, return_format: return_format } \n    $this.addClass('os-loading');\n    $.ajax({\n      type : \"post\",\n      dataType : \"json\",\n      url : latepoint_helper.ajaxurl,\n      data : data,\n      success: function(response){\n        if(response.status === \"success\"){\n          if($this.data('os-output-target') == 'lightbox'){\n            latepoint_show_data_in_lightbox(response.message, $this.data('os-lightbox-classes'));\n          }else if($this.data('os-output-target') == 'side-panel'){\n            $('.latepoint-side-panel-w').remove();\n            $('body').append('<div class=\"latepoint-side-panel-w\"><div class=\"latepoint-side-panel-i\">' + response.message + '</div><div class=\"latepoint-side-panel-shadow\"></div></div>');\n          }else if($this.data('os-success-action') == 'reload'){\n            latepoint_add_notification(response.message);\n            location.reload();\n            return;\n          }else if($this.data('os-success-action') == 'redirect'){\n            if($this.data('os-redirect-to')){\n              latepoint_add_notification(response.message);\n              window.location.replace($this.data('os-redirect-to'));\n            }else{\n              window.location.replace(response.message); \n            }\n            return;\n          }else if($this.data('os-output-target') && $($this.data('os-output-target')).length){\n            if($this.data('os-output-target-do') == 'append'){\n              $($this.data('os-output-target')).append(response.message);\n            }else{\n              $($this.data('os-output-target')).html(response.message);\n            }\n          }else{\n            if($this.data('os-before-after') == 'before'){\n              $this.before(response.message);\n            }else if($this.data('os-before-after') == 'before'){\n              $this.after(response.message);\n            }else{\n              latepoint_add_notification(response.message);\n            }\n          }\n          if($this.data('os-after-call')){\n            var func_name = $this.data('os-after-call');\n            if($this.data('os-pass-this')){\n              window[func_name]($this);\n            }else if($this.data('os-pass-response')){\n              window[func_name](response);\n            }else{\n              window[func_name]();\n            }\n          }\n          $this.removeClass('os-loading');\n        }else{\n          $this.removeClass('os-loading');\n          if($this.data('os-output-target') && $($this.data('os-output-target')).length){\n            $($this.data('os-output-target')).prepend(latepoint_generate_form_message_html(response.message, 'error'));\n          }else{\n            alert(response.message);\n          }\n        }\n      }\n    });\n    return false;\n  });\n\n\n  $('.latepoint').on('click', 'form[data-os-action] button[type=\"submit\"]', function(e){\n    $(this).addClass('os-loading');\n  });\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  /* \n    Form ajax submit action\n  */\n  $('.latepoint').on('submit', 'form[data-os-action]', function(e){\n    e.preventDefault(); // prevent native submit\n    var $form = $(this);\n    var form_data = $form.serialize();\n    var data = { action: 'latepoint_route_call', route_name: $(this).data('os-action'), params: form_data, return_format: 'json' }\n    $form.find('button[type=\"submit\"]').addClass('os-loading');\n    $.ajax({\n      type : \"post\",\n      dataType : \"json\",\n      url : latepoint_helper.ajaxurl,\n      data : data,\n      success: function(response){\n        $form.find('button[type=\"submit\"].os-loading').removeClass('os-loading');\n        latepoint_clear_form_messages($form);\n        if(response.status === \"success\"){\n          if($form.data('os-success-action') == 'reload'){\n            latepoint_add_notification(response.message);\n            location.reload();\n            return;\n          }else if($form.data('os-success-action') == 'redirect'){\n            if($form.data('os-redirect-to')){\n              latepoint_add_notification(response.message);\n              window.location.replace($form.data('os-redirect-to'));\n            }else{\n              window.location.replace(response.message);\n            }\n            return;\n          }else if($form.data('os-output-target') && $($form.data('os-output-target')).length){\n            $($form.data('os-output-target')).html(response.message);\n          }else{\n            if(response.message == 'redirect'){\n              window.location.replace(response.url);\n            }else{\n              latepoint_add_notification(response.message);\n              $form.prepend(latepoint_generate_form_message_html(response.message, 'success'));\n            }\n          }\n          if($form.data('os-record-id-holder') && response.record_id){\n            $form.find('[name=\"' + $form.data('os-record-id-holder') + '\"]').val(response.record_id)\n          }\n          if($form.data('os-after-call')){\n            var func_name = $form.data('os-after-call');\n            if($form.data('os-pass-response')){\n              window[func_name](response);\n            }else{\n              window[func_name]();\n            }\n          }\n          $('button.os-loading').removeClass('os-loading');\n        }else{\n          $('button.os-loading').removeClass('os-loading');\n          if($form.data('os-show-errors-as-notification')){\n            latepoint_add_notification(response.message, 'error');\n          }else{\n            $form.prepend(latepoint_generate_form_message_html(response.message, 'error'));\n            $([document.documentElement, document.body]).animate({\n                scrollTop: ($form.find(\".os-form-message-w\").offset().top - 30)\n            }, 200);\n          }\n        }\n        if(response.form_values_to_update){\n          $.each(response.form_values_to_update, function(name, value){\n            $form.find('[name=\"'+ name +'\"]').val(value);\n          });\n        }\n      }\n    });\n    return false;\n  });\n});","// @codekit-prepend \"os-time.js\"\n// @codekit-prepend \"os-shared.js\"\n// @codekit-prepend \"os-notifications.js\";\n// @codekit-prepend \"os-actions.js\"\n\n\n\n  function latepoint_init_payment_method_actions($booking_form_element, payment_method){\n    var callbacks_list = [];\n    var is_last_step = $booking_form_element.data('next-submit-is-last') == 'yes';\n    $booking_form_element.trigger('latepoint:initPaymentMethod', [{ payment_method: payment_method, \n                                                                    callbacks_list: callbacks_list, \n                                                                    is_last_step: is_last_step }]);\n    $booking_form_element.removeClass('step-content-loaded').addClass('step-content-loading');\n    jQuery.when(...callbacks_list.map(callback => callback.action()))\n      .done(() => {\n        $booking_form_element.removeClass('step-content-loading').addClass('step-content-loaded').find('.lp-payment-method-content[data-payment-method=\"' + payment_method + '\"]').show();\n    });\n  }\n\n  function latepoint_show_next_btn($booking_form_element){\n    $booking_form_element.find('.latepoint-next-btn').removeClass('disabled');\n    $booking_form_element.removeClass('hidden-buttons');\n  }\n\n  function clear_step_services($booking_form_element){\n    latepoint_update_summary_field($booking_form_element, 'service', '');\n    clear_sub_step_attendies($booking_form_element);\n  }\n\n  function clear_sub_step_attendies($booking_form_element){\n    $booking_form_element.find('.latepoint_total_attendies').val(1);\n    latepoint_update_summary_field($booking_form_element, 'total-attendies', '');\n    clear_sub_step_duration($booking_form_element);\n  }\n\n  function clear_sub_step_duration($booking_form_element){\n    $booking_form_element.find('.latepoint_duration').val('');\n    latepoint_update_summary_field($booking_form_element, 'duration', '');\n  }\n\n  function clear_step_service_extras($booking_form_element){\n    latepoint_update_summary_field($booking_form_element, 'service-extras', '');\n  }\n\n  function clear_step_locations($booking_form_element){\n    latepoint_update_summary_field($booking_form_element, 'location', '');\n  }\n\n  function clear_step_agents($booking_form_element){\n    latepoint_update_summary_field($booking_form_element, 'agent', '');\n  }\n\n  function clear_step_datepicker($booking_form_element){\n    latepoint_update_summary_field($booking_form_element, 'time', '');\n    latepoint_update_summary_field($booking_form_element, 'date', '');\n  }\n\n  function latepoint_hide_next_btn($booking_form_element){\n    $booking_form_element.find('.latepoint-next-btn').addClass('disabled');\n    if($booking_form_element.find('.latepoint-prev-btn.disabled').length) $booking_form_element.addClass('hidden-buttons');\n  }\n\n\n  function latepoint_show_prev_btn($booking_form_element){\n    $booking_form_element.find('.latepoint-prev-btn').removeClass('disabled');\n    $booking_form_element.removeClass('hidden-buttons');\n  }\n\n  function latepoint_hide_prev_btn($booking_form_element){\n    $booking_form_element.find('.latepoint-prev-btn').addClass('disabled');\n    if($booking_form_element.find('.latepoint-next-btn.disabled').length) $booking_form_element.addClass('hidden-buttons');\n  }\n\n\nfunction latepoint_show_capacity_selector($item){\n  var $booking_form_element = $item.closest('.latepoint-booking-form-element');\n  var max_capacity = $item.data('max-capacity');\n  var min_capacity = $item.data('min-capacity');\n  $booking_form_element.find('.sta-sub-label span').text(max_capacity);\n  $booking_form_element.find('.step-services-w').removeClass('selecting-service-duration');\n  $booking_form_element.find('.total-attendies-selector-w').data('max-capacity', max_capacity);\n  $booking_form_element.find('.total-attendies-selector-w').data('min-capacity', min_capacity);\n  $item.closest('.step-services-w').addClass('selecting-total-attendies');\n  $booking_form_element.find('.total-attendies-selector-input').val(min_capacity);\n  latepoint_show_prev_btn($booking_form_element);\n  latepoint_show_next_btn($booking_form_element);\n}\n\n\nfunction latepoint_show_durations($item){\n  var $booking_form_element = $item.closest('.latepoint-booking-form-element');\n  $item.closest('.step-services-w').addClass('selecting-service-duration');\n  latepoint_show_prev_btn($booking_form_element);\n  latepoint_hide_next_btn($booking_form_element);\n}\n\nfunction latepoint_apply_coupon($elem){\n  var $booking_form_element = $elem.closest('.latepoint-booking-form-element');\n\n  var $coupon_input = $elem;\n  $coupon_input.closest('.coupon-code-input-w').addClass('os-loading');\n  var form_params = $booking_form_element.find('.latepoint-form').serialize();\n  var data = { action: 'latepoint_route_call', route_name: $elem.data('route'), params: form_params, layout: 'none', return_format: 'json' }\n  jQuery.ajax({\n    type : \"post\",\n    dataType : \"json\",\n    url : latepoint_helper.ajaxurl,\n    data : data,\n    success: function(data){\n      $coupon_input.closest('.coupon-code-input-w').removeClass('os-loading');\n      if(data.status === \"success\"){\n        $booking_form_element.find('input[name=\"booking[coupon_code]\"]').val($coupon_input.val());\n        latepoint_show_message_inside_element(data.message, $booking_form_element.find('.latepoint-body'), 'success');\n        $booking_form_element.find('.step-payment-w input[name=\"booking[payment_method]\"]').val('');\n        $booking_form_element.find('input[name=\"booking[payment_token]\"]').val('');\n        $booking_form_element.find('input[name=\"booking[payment_portion]\"]').val('');\n        latepoint_reload_step($booking_form_element);\n      }else{\n        latepoint_show_message_inside_element(data.message, $booking_form_element.find('.latepoint-body'), 'error');\n      }\n    }\n  });\n}\n\nfunction latepoint_remove_coupon($elem){\n  $elem.closest('.applied-coupon-code').fadeOut();\n  var $booking_form_element = $elem.closest('.latepoint-booking-form-element');\n  $booking_form_element.find('input[name=\"booking[coupon_code]\"]').val('');\n  latepoint_reload_step($booking_form_element);\n}\n\nfunction latepoint_reload_step($booking_form_element, step_name = false){\n\n  if(step_name){\n    $booking_form_element.find('.latepoint_current_step').val(step_name);\n    $booking_form_element.removeClass(function (index, className) { return (className.match (/(^|\\s)current-step-\\S+/g) || []).join(' '); }).addClass('current-step-' + step_name);\n    if($booking_form_element.find('.latepoint-step-content[data-step-name=\"'+ step_name +'\"]')){\n      $booking_form_element.find('.latepoint-step-content[data-step-name=\"'+ step_name +'\"]').nextAll('.latepoint-step-content').remove();\n      $booking_form_element.find('.latepoint-step-content[data-step-name=\"'+ step_name +'\"]').remove();\n    }\n  }\n\n  $booking_form_element.find('.latepoint_step_direction').val('specific');\n  $booking_form_element.find('.latepoint-form').submit();\n\n  return false;\n}\n\nfunction latepoint_get_payment_sub_step($booking_form_element, current_sub_step, prev = false){\n  var offset = prev ? -1 : 1;\n  var payment_sub_steps = [];\n  if($booking_form_element.find('.step-payment-w .lp-payment-times-w').length) payment_sub_steps.push('payment-times');\n  if($booking_form_element.find('.step-payment-w .lp-payment-methods-w').length) payment_sub_steps.push('payment-methods');\n  if($booking_form_element.find('.step-payment-w .lp-payment-portions-w').length) payment_sub_steps.push('payment-portions');\n\n  var selected_payment_method = $booking_form_element.find('input[name=\"booking[payment_method]\"]').val();\n  if(selected_payment_method) payment_sub_steps.push('payment-method-content');\n\n  var index = payment_sub_steps.indexOf(current_sub_step) + offset;\n  if(index >= 0 && index < payment_sub_steps.length){\n    var sub_step = payment_sub_steps[index];\n    if(sub_step == 'payment-method-content'){\n      latepoint_init_payment_method_actions($booking_form_element, selected_payment_method);\n      // if no content exists for payment method - do not change sub step\n      if(!$booking_form_element.find('.lp-payment-method-content[data-payment-method=\"' + selected_payment_method + '\"]').length) sub_step = current_sub_step;\n    }\n    return sub_step;\n  }else{\n    return current_sub_step;\n  }\n}\n\n\nfunction latepoint_reset_password_from_booking_init(){\n  jQuery('.os-step-existing-customer-login-w').hide();\n  jQuery('.os-password-reset-form-holder').on('click', '.password-reset-back-to-login', function(){\n    jQuery('.os-password-reset-form-holder').html('');\n    jQuery('.os-step-existing-customer-login-w').show();\n    return false;\n  });\n}\n\nfunction latepoint_update_summary_field($form, field_name, value = ''){\n  var $summary_holder = $form.closest('.latepoint-with-summary');\n  if(!$summary_holder.length) return;\n  value = value ? String(value).trim() : false;\n  if(value){\n    $form.find('.os-summary-value-'+field_name).html(value).closest('.os-summary-line').addClass('os-has-value');\n    if($summary_holder.hasClass('latepoint-summary-is-open')){\n      $form.find('.os-summary-line.os-has-value').slideDown(150);\n    }else{\n      $form.find('.os-summary-line.os-has-value').fadeIn(200);\n    }\n    $summary_holder.addClass('latepoint-summary-is-open');\n  }else{\n    $form.find('.os-summary-value-'+field_name).text('').closest('.os-summary-line').slideUp(150).removeClass('os-has-value');\n  }\n}\n\nfunction latepoint_password_changed_show_login(response){\n  jQuery('.os-step-existing-customer-login-w').show();\n  jQuery('.os-password-reset-form-holder').html('');\n  latepoint_show_message_inside_element(response.message, jQuery('.os-step-existing-customer-login-w'), 'success');\n}\n\nfunction latepoint_hide_message_inside_element($elem = jQuery('.latepoint-body')){\n  if($elem.length && $elem.find('.latepoint-message').length){\n    $elem.find('.latepoint-message').remove();\n  }\n}\n\nfunction latepoint_show_message_inside_element(message, $elem = jQuery('.latepoint-body'), message_type = 'error'){\n  if($elem.length){\n    if($elem.find('.latepoint-message').length){\n      $elem.find('.latepoint-message').removeClass('latepoint-message-success').removeClass('latepoint-message-error').addClass('latepoint-message-'+ message_type +'').html(message).show();\n    }else{\n      $elem.prepend('<div class=\"latepoint-message latepoint-message-'+ message_type +'\">' + message + '</div>');\n    }\n  }\n}\n\nfunction latepoint_add_action(callbacks_list, action, priority = 10){\n  callbacks_list.push({priority: priority, action: action});\n  callbacks_list.sort((a,b) => a.priority - b.priority);\n  return callbacks_list;\n}\n\n\n( function( $ ) {\n  \"use strict\";\n\n  function latepoint_init_step(step_name, $booking_form_element){\n    latepoint_init_step_selectable_items();\n    switch(step_name){\n      case 'datepicker':\n        latepoint_init_step_datepicker();\n      break;\n      case 'contact':\n        latepoint_init_step_contact();\n      break;\n      case 'agents':\n        latepoint_init_step_agents();\n      break;\n      case 'locations':\n        latepoint_init_step_locations();\n      break;\n      case 'services':\n        latepoint_init_step_services();\n      break;\n      case 'payment':\n        latepoint_init_step_payment($booking_form_element);\n      break;\n      case 'verify':\n        latepoint_init_step_verify($booking_form_element);\n      break;\n      case 'confirmation':\n        latepoint_init_step_confirmation();\n      break;\n    }\n\n    $booking_form_element.trigger(\"latepoint:initStep\", [{step_name: step_name}]);\n    $booking_form_element.trigger(\"latepoint:initStep:\" + step_name);\n  }\n\n\n\n  function day_timeslots($day){\n    var $booking_form_element = $day.closest('.latepoint-booking-form-element');\n    $day.addClass('selected');\n\n    var service_duration = $day.data('service-duration');\n    var interval = $day.data('interval');\n    var work_start_minutes = $day.data('work-start-time');\n    var work_end_minutes = $day.data('work-end-time');\n    var total_work_minutes = $day.data('total-work-minutes');\n    var available_minutes = $day.attr('data-available-minutes') ? $day.data('available-minutes').toString().split(',').map(Number) : false;\n    var day_minutes = $day.data('day-minutes').toString().split(',').map(Number);\n\n    var $timeslots = $booking_form_element.find('.timeslots');\n    $timeslots.html('');\n\n    if(total_work_minutes > 0 && available_minutes.length && day_minutes.length){\n      var prev_minutes = false;\n      day_minutes.forEach(function(current_minutes){\n        if((current_minutes + service_duration) > work_end_minutes) return;\n        var ampm = latepoint_am_or_pm(current_minutes);\n        \n        var timeslot_class = 'dp-timepicker-trigger';\n        if(latepoint_helper.time_pick_style == 'timeline'){\n          timeslot_class+= ' dp-timeslot';\n        }else{\n          timeslot_class+= ' dp-timebox';\n        }\n\n        if(prev_minutes !== false && ((current_minutes - prev_minutes) > service_duration)){\n          // show interval that is off between two work periods\n          var off_label = latepoint_minutes_to_hours_and_minutes(prev_minutes + service_duration)+' '+ latepoint_am_or_pm(prev_minutes + service_duration) + ' - ' + latepoint_minutes_to_hours_and_minutes(current_minutes)+' '+latepoint_am_or_pm(current_minutes);\n          var off_width = (((current_minutes - prev_minutes - service_duration) / (total_work_minutes + service_duration)) * 100);\n          $timeslots.append('<div class=\"'+ timeslot_class +' is-off\" style=\"max-width:'+ off_width +'%; width:'+ off_width +'%\"><span class=\"dp-label\">' + off_label + '</span></div>');\n        }\n\n        if(!available_minutes.includes(current_minutes)){\n          timeslot_class+= ' is-booked';\n        }\n        var tick_html = '';\n        if(((current_minutes % 60) == 0) || (interval >= 60)){\n          timeslot_class+= ' with-tick';\n          tick_html = '<span class=\"dp-tick\"><strong>'+latepoint_minutes_to_hours_preferably(current_minutes)+'</strong>'+' '+ampm+'</span>';\n        }\n        var timeslot_label = latepoint_minutes_to_hours_and_minutes(current_minutes)+' '+ampm;\n        if(latepoint_show_booking_end_time()){\n          var end_minutes = current_minutes + service_duration;\n          var end_minutes_ampm = latepoint_am_or_pm(end_minutes);\n          timeslot_label+= ' - <span class=\"dp-label-end-time\">' + latepoint_minutes_to_hours_and_minutes(end_minutes)+' '+end_minutes_ampm + '</span>';\n        }\n        timeslot_label = timeslot_label.trim();\n        $timeslots.removeClass('slots-not-available').append('<div class=\"'+timeslot_class+'\" data-minutes=\"' + current_minutes + '\"><span class=\"dp-label\">'+ timeslot_label +'</span>'+tick_html+'</div>');\n        prev_minutes = current_minutes;\n      });\n    }else{\n      // No working hours this day\n      $timeslots.addClass('slots-not-available').append('<div class=\"not-working-message\">' + latepoint_helper.msg_not_available + \"</div>\");\n    }\n    $('.times-header-label span').text($day.data('nice-date'));\n    $booking_form_element.find('.time-selector-w').slideDown(200, function(){\n      var $scrollable_wrapper = $booking_form_element.find('.latepoint-body');\n      $scrollable_wrapper.stop().animate({\n        scrollTop: $scrollable_wrapper[0].scrollHeight\n      }, 200);\n    });\n  }\n\n\n\n\n  function os_init_timeslots(){\n    $('.dp-timepicker-trigger').on('click', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      if($(this).hasClass('is-booked') || $(this).hasClass('is-off')){\n        // Show error message that you cant select a booked period\n      }else{\n        if($(this).hasClass('selected')){\n          $(this).removeClass('selected');\n          $(this).find('.dp-success-label').remove();\n          $booking_form_element.find('.latepoint_start_time').val('');\n          latepoint_hide_next_btn($booking_form_element);\n          latepoint_update_summary_field($booking_form_element, 'time', '');\n        }else{\n          $booking_form_element.find('.dp-timepicker-trigger.selected').removeClass('selected').find('.dp-success-label').remove();\n          var selected_timeslot_time = $(this).find('.dp-label').html();\n          $(this).addClass('selected').find('.dp-label').html('<span class=\"dp-success-label\">' + $booking_form_element.find('.latepoint-form').data('selected-label') + '</span>' + selected_timeslot_time);\n          $booking_form_element.find('.latepoint_start_time').val($(this).data('minutes'));\n          latepoint_show_next_btn($booking_form_element);\n          latepoint_update_summary_field($booking_form_element, 'time', selected_timeslot_time);\n        }\n      }\n      return false;\n    });\n  }\n\n  function os_init_monthly_calendar_navigation(){\n    $('.os-month-next-btn').on('click', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      var next_month_route_name = $(this).data('route');\n      if($booking_form_element.find('.os-monthly-calendar-days-w.active + .os-monthly-calendar-days-w').length){\n        $booking_form_element.find('.os-monthly-calendar-days-w.active').removeClass('active').next('.os-monthly-calendar-days-w').addClass('active');\n        latepoint_calendar_set_month_label($booking_form_element);\n      }else{\n        // TODO add condition to check maximum number months to call into the future\n        if(true){\n          var $btn = $(this);\n          $btn.addClass('os-loading');\n          var $calendar_element = $booking_form_element.find('.os-monthly-calendar-days-w').last();\n          var calendar_year = $calendar_element.data('calendar-year');\n          var calendar_month = $calendar_element.data('calendar-month');\n          if(calendar_month == 12){\n            calendar_year = calendar_year + 1;\n            calendar_month = 1;\n          }else{\n            calendar_month = calendar_month + 1;\n          }\n          var booking_info = { target_date_string: calendar_year + '-' + calendar_month + '-1', \n                                location_id: $booking_form_element.find('.latepoint_location_id').val(), \n                                agent_id: $booking_form_element.find('.latepoint_agent_id').val(), \n                                service_id: $booking_form_element.find('.latepoint_service_id').val(),\n                                duration: $booking_form_element.find('input[name=\"booking[duration]\"]').val(),\n                                total_attendies: $booking_form_element.find('input[name=\"booking[total_attendies]\"]').val() };\n          var data = { action: 'latepoint_route_call', route_name: next_month_route_name, params: booking_info, layout: 'none', return_format: 'json' }\n          $.ajax({\n            type : \"post\",\n            dataType : \"json\",\n            url : latepoint_helper.ajaxurl,\n            data : data,\n            success: function(data){\n              $btn.removeClass('os-loading');\n              if(data.status === \"success\"){\n                $booking_form_element.find('.os-months').append(data.message);\n                $booking_form_element.find('.os-monthly-calendar-days-w.active').removeClass('active').next('.os-monthly-calendar-days-w').addClass('active');\n                latepoint_calendar_set_month_label($booking_form_element);\n              }else{\n                // console.log(data.message);\n              }\n            }\n          });\n        }\n      }\n      latepoint_calendar_show_or_hide_prev_next_buttons($booking_form_element);\n      return false;\n    });\n    $('.os-month-prev-btn').on('click', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      if($booking_form_element.find('.os-monthly-calendar-days-w.active').prev('.os-monthly-calendar-days-w').length){\n        $booking_form_element.find('.os-monthly-calendar-days-w.active').removeClass('active').prev('.os-monthly-calendar-days-w').addClass('active');\n        latepoint_calendar_set_month_label($booking_form_element);\n      }\n      latepoint_calendar_show_or_hide_prev_next_buttons($booking_form_element);\n      return false;\n    });\n  }\n\n  function latepoint_calendar_set_month_label($booking_form_element){\n    $booking_form_element.find('.os-current-month-label .current-year').text($booking_form_element.find('.os-monthly-calendar-days-w.active').data('calendar-year'));\n    $booking_form_element.find('.os-current-month-label .current-month').text($booking_form_element.find('.os-monthly-calendar-days-w.active').data('calendar-month-label'));\n  }\n\n\n  function latepoint_calendar_show_or_hide_prev_next_buttons($booking_form_element){\n    $booking_form_element.find('.os-current-month-label .current-year').text($booking_form_element.find('.os-monthly-calendar-days-w.active .os-monthly-calendar-days').data('calendar-year'));\n    $booking_form_element.find('.os-current-month-label .current-month').text($booking_form_element.find('.os-monthly-calendar-days-w.active .os-monthly-calendar-days').data('calendar-month-label'));\n\n    if($booking_form_element.find('.os-monthly-calendar-days-w.active').prev('.os-monthly-calendar-days-w').length){\n      $booking_form_element.find('.os-month-prev-btn').removeClass('disabled');\n    }else{\n      $booking_form_element.find('.os-month-prev-btn').addClass('disabled');\n    }\n  }\n\n  function latepoint_format_minutes_to_time(minutes, service_duration){\n    var ampm = latepoint_am_or_pm(minutes);\n    var formatted_time = latepoint_minutes_to_hours_and_minutes(minutes)+' '+ampm;\n    if(latepoint_show_booking_end_time()){\n      var end_minutes = minutes + service_duration;\n      var end_minutes_ampm = latepoint_am_or_pm(end_minutes);\n      formatted_time+= ' - ' + latepoint_minutes_to_hours_and_minutes(end_minutes)+' '+end_minutes_ampm;\n    }\n    formatted_time = formatted_time.trim();\n    return formatted_time;\n  }\n\n  function latepoint_init_step_datepicker(){\n    os_init_timeslots();\n    os_init_monthly_calendar_navigation();\n    $('.os-months').on('click', '.os-day', function(){\n      if($(this).hasClass('os-day-passed')) return false;\n      if($(this).hasClass('os-not-in-allowed-period')) return false;\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      if($(this).closest('.os-monthly-calendar-days-w').hasClass('hide-if-single-slot')){\n\n        // HIDE TIMESLOT IF ONLY ONE TIMEPOINT\n        if($(this).hasClass('os-not-available')){\n          // clicked on a day that has no available timeslots\n          // do nothing\n        }else{\n          $booking_form_element.find('.os-day.selected').removeClass('selected');\n          $(this).addClass('selected');\n          // set date\n          $booking_form_element.find('.latepoint_start_date').val($(this).data('date'));\n          latepoint_update_summary_field($booking_form_element, 'date', $(this).data('nice-date'));\n          if($(this).hasClass('os-one-slot-only')){\n            // clicked on a day that has only one slot available\n            var selected_timeslot_time = latepoint_format_minutes_to_time($(this).data('available-minutes'), $(this).data('service-duration'));\n            $booking_form_element.find('.latepoint_start_time').val($(this).data('available-minutes'));\n            latepoint_show_next_btn($booking_form_element);\n            latepoint_update_summary_field($booking_form_element, 'time', selected_timeslot_time);\n          }else{\n            // regular day with more than 1 timeslots available\n            // build timeslots\n            day_timeslots($(this));\n            // initialize timeslots events\n            os_init_timeslots();\n            // clear time and hide next btn\n            $booking_form_element.find('.latepoint_start_time').val('');\n            latepoint_hide_next_btn($booking_form_element);\n          }\n        }\n      }else{\n        \n        // SHOW TIMESLOTS EVEN IF ONLY ONE TIMEPOINT\n        $booking_form_element.find('.latepoint_start_date').val($(this).data('date'));\n        latepoint_update_summary_field($booking_form_element, 'date', $(this).data('nice-date'));\n        $booking_form_element.find('.os-day.selected').removeClass('selected');\n        $(this).addClass('selected');\n\n        // build timeslots\n        day_timeslots($(this));\n        // initialize timeslots events\n        os_init_timeslots();\n        // clear time and hide next btn\n        latepoint_update_summary_field($booking_form_element, 'time', '');\n        $booking_form_element.find('.latepoint_start_time').val('');\n        latepoint_hide_next_btn($booking_form_element);\n      }\n\n\n      return false;\n    });\n  }\n\n\n  function latepoint_init_step_verify($booking_form_element = false){\n    if(!$booking_form_element) return;\n\n    $booking_form_element.closest('.latepoint-summary-is-open').removeClass('latepoint-summary-is-open');\n  }\n\n\n  function latepoint_init_step_payment($booking_form_element = false){\n    if($booking_form_element.find('.step-payment-w').data('full-amount') > 0){\n      latepoint_update_summary_field($booking_form_element, 'price', latepoint_format_price(($booking_form_element.find('.step-payment-w').data('full-amount') * 100 / 100).toFixed(2)));\n    }\n    if($booking_form_element && ($booking_form_element.find('.step-payment-w').data('default-portion') == 'deposit')){\n      $booking_form_element.find('input[name=\"booking[payment_portion]\"]').val('deposit');\n    }\n\n    // activate payment method content if method and portion are set and no selection is needed\n    var selected_payment_method = $booking_form_element.find('input[name=\"booking[payment_method]\"]').val();\n    if(selected_payment_method && !$('.lp-payment-times-w').length && !$('.lp-payment-methods-w').length && !$('.lp-payment-portions-w').length){\n      latepoint_init_payment_method_actions($booking_form_element, selected_payment_method);\n    }\n\n    $('.latepoint-booking-form-element .coupon-code-input-submit').on('click', function(e){\n      latepoint_apply_coupon($(this).closest('.coupon-code-input-w').find('.coupon-code-input'));\n      return false;\n    });\n\n    $('.latepoint-booking-form-element .coupon-code-clear').on('click', function(e){\n      latepoint_remove_coupon($(this));\n      return false;\n    });\n\n    $('.latepoint-booking-form-element input.coupon-code-input').on('keyup', function(e){\n      if(e.which === 13){\n        latepoint_apply_coupon($(this));\n        return false;\n      }\n    });\n\n\n    $('.latepoint-booking-form-element .coupon-code-trigger-w a').on('click', function(e){\n      $(this).closest('.payment-total-info').addClass('entering-coupon').find('.coupon-code-input').focus();\n      return false;\n    });\n\n\n    // Pay later button click\n    $('.latepoint-booking-form-element .lp-payment-trigger-later').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_element.find('input[name=\"booking[payment_method]\"]').val($(this).data('method'));\n      $booking_form_element.find('input[name=\"booking[payment_portion]\"]').val('');\n      $booking_form_element.find('.latepoint-form').submit();\n    });\n\n\n    // Selecting Payment Time\n    $('.latepoint-booking-form-element .lp-payment-trigger-payment-time-selector').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      var $payment_step = $booking_form_element.find('.step-payment-w');\n\n      latepoint_hide_next_btn($booking_form_element);\n      latepoint_show_prev_btn($booking_form_element);\n      $payment_step.attr('data-sub-step', latepoint_get_payment_sub_step($booking_form_element, $payment_step.attr('data-sub-step')));\n      return false;\n    });\n\n    // Selecting Payment Method\n    $('.latepoint-booking-form-element .lp-payment-trigger-payment-method-selector').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      var selected_payment_method = $(this).data('method');\n      $booking_form_element.find('input[name=\"booking[payment_method]\"]').val(selected_payment_method);\n\n      var $payment_step = $booking_form_element.find('.step-payment-w');\n      latepoint_hide_next_btn($booking_form_element);\n      latepoint_show_prev_btn($booking_form_element);\n      $payment_step.attr('data-sub-step', latepoint_get_payment_sub_step($booking_form_element, $payment_step.attr('data-sub-step')));\n    });\n\n    $('.latepoint-booking-form-element .lp-payment-trigger-payment-portion-selector').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      var portion = jQuery(this).data('portion');\n      $booking_form_element.find('input[name=\"booking[payment_portion]\"]').val(portion);\n      if(portion == 'deposit'){\n        $booking_form_element.find('.payment-total-info').addClass('paying-deposit');\n      }else{\n        $booking_form_element.find('.payment-total-info').removeClass('paying-deposit');\n      }\n\n      var $payment_step = $booking_form_element.find('.step-payment-w');\n      latepoint_hide_next_btn($booking_form_element);\n      latepoint_show_prev_btn($booking_form_element);\n      $payment_step.attr('data-sub-step', latepoint_get_payment_sub_step($booking_form_element, $payment_step.attr('data-sub-step')));\n    });\n\n\n  }\n\n\n  function latepoint_init_step_selectable_items(){\n    $('.os-selectable-items .os-selectable-item').off('click', latepoint_selectable_item_clicked);\n    $('.os-selectable-items .os-selectable-item').on('click', latepoint_selectable_item_clicked);\n\n    $('.os-selectable-items .os-selectable-item .item-quantity-selector-input').off('keyup', latepoint_selectable_item_quantity_keyup);\n    $('.os-selectable-items .os-selectable-item .item-quantity-selector-input').on('keyup', latepoint_selectable_item_quantity_keyup);\n  }\n\n\n  function latepoint_calculate_total_price($booking_form_element){\n    $booking_form_element.find('.os-summary-value.os-summary-value-price').addClass('os-loading');\n    var $booking_form = $booking_form_element.find('.latepoint-form');\n    var form_data = $booking_form.serialize();\n    var data = { action: 'latepoint_route_call', route_name: latepoint_helper.calculate_price_route, params: form_data, layout: 'none', return_format: 'json'}\n    $.ajax({\n      type : \"post\",\n      dataType : \"json\",\n      url : latepoint_helper.ajaxurl,\n      data : data,\n      success: function(data){\n        if(data.status === \"success\"){\n          latepoint_update_summary_field($booking_form_element, 'price', data.price);\n          $booking_form_element.find('.os-summary-value.os-summary-value-price').removeClass('os-loading');\n        }\n      }\n    });\n    return;\n  }\n\n  function latepoint_update_quantity_for_selectable_items($item){\n      var ids = $item.closest('.os-selectable-items')\n                        .find('.os-selectable-item.selected')\n                        .map(function(){ \n                          if($(this).hasClass('has-quantity')){\n                            return $(this).data('item-id') + ':' + $(this).find('input.item-quantity-selector-input').val();\n                          }else{\n                            return $(this).data('item-id');\n                          }\n                        }).get();\n      $item.closest('.latepoint-booking-form-element').find($item.data('id-holder')).val(ids);\n  }\n\n  function latepoint_selectable_item_quantity_keyup(event){\n    var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n    var $item = $(this).closest('.os-selectable-item');\n    var new_value = $(this).val();\n    if(new_value && new_value.match(/^\\d+$/)){\n      var max_quantity = $item.data('max-quantity');\n      if(max_quantity && (new_value > max_quantity)) new_value = max_quantity;\n    }else{\n      new_value = 0;\n    }\n    $(this).val(new_value);\n\n    if(( $item.hasClass('selected') && (new_value > 0) ) || (!$item.hasClass('selected') && (new_value == 0))){\n      latepoint_update_quantity_for_selectable_items($item);\n      latepoint_calculate_total_price($booking_form_element);\n      return false;\n    }else{\n      $item.trigger('click');\n    }\n  }\n\n  function latepoint_selectable_item_clicked(event){\n    event.stopPropagation();\n    event.stopImmediatePropagation();\n    var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n    if($(this).hasClass('has-quantity')){\n      if($(event.target).hasClass('item-quantity-selector')){\n        var current_value = parseInt($(this).find('input.item-quantity-selector-input').val());\n        var new_value = ($(event.target).data('sign') == 'minus') ? current_value - 1 : current_value + 1;\n        var max_quantity = $(this).data('max-quantity');\n        if(new_value < 0) new_value = 0;\n        if(max_quantity && (new_value > max_quantity)) new_value = max_quantity;\n        $(this).find('input.item-quantity-selector-input').val(new_value);\n        if(( $(this).hasClass('selected') && (new_value > 0) ) || (!$(this).hasClass('selected') && (new_value == 0))){\n          latepoint_update_quantity_for_selectable_items($(this));\n          latepoint_calculate_total_price($booking_form_element);\n          return false;\n        }\n      }\n      if($(event.target).hasClass('item-quantity-selector-input')){\n        latepoint_update_quantity_for_selectable_items($(this));\n        latepoint_calculate_total_price($booking_form_element);\n        return false;\n      }\n    }\n    var summary_value = '';\n    if($(this).hasClass('os-allow-multiselect')){\n      if($(this).hasClass('selected')){\n        $(this).removeClass('selected');\n        if($(this).hasClass('has-quantity')) $(this).find('input.item-quantity-selector-input').val(0);\n      }else{\n        $(this).addClass('selected');\n        if($(this).hasClass('has-quantity') && !($(this).find('input.item-quantity-selector-input').val() > 0)){\n          $(this).find('input.item-quantity-selector-input').val(1);\n        }\n      }\n      latepoint_update_quantity_for_selectable_items($(this));\n      summary_value = String($(this).closest('.os-selectable-items').find('.os-selectable-item.selected').map(function(){ return (' ' + $(this).data('summary-value')); }).get()).trim();\n      latepoint_show_next_btn($booking_form_element);\n    }else{\n      if(!$(this).hasClass('os-duration-item')) $(this).closest('.os-service-categories-main-parent').find('.os-selectable-item.selected').removeClass('selected');\n      $(this).closest('.os-selectable-items').find('.os-selectable-item.selected').removeClass('selected');\n      $(this).addClass('selected');\n      $booking_form_element.find($(this).data('id-holder')).val($(this).data('item-id'));\n      summary_value = $(this).data('summary-value');\n      if($(this).data('os-call-func')){\n        window[$(this).data('os-call-func')]($(this));\n      }\n      if($(this).data('activate-sub-step')){\n        window[$(this).data('activate-sub-step')]($(this));\n      }else{\n        latepoint_trigger_next_btn($booking_form_element);\n      }\n    }\n    latepoint_update_summary_field($booking_form_element, $(this).data('summary-field-name'), summary_value);\n    if($(this).hasClass('os-priced-item')){\n      latepoint_calculate_total_price($booking_form_element);\n    }\n  }\n\n\n  function latepoint_format_price(price){\n    return latepoint_helper.currency_symbol_before + String(price) + latepoint_helper.currency_symbol_after;\n  }\n\n\n  function latepoint_init_step_services(){\n    $('.total-attendies-selector-input').on('change', function(){\n      var max_capacity = $(this).closest('.total-attendies-selector-w').data('max-capacity');\n      var min_capacity = $(this).closest('.total-attendies-selector-w').data('min-capacity');\n      var new_value = $(this).val();\n      new_value = Math.min(Number(max_capacity), Number(new_value));\n      new_value = Math.max(Number(min_capacity), Number(new_value));\n      $(this).val(new_value);\n\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      latepoint_update_summary_field($booking_form_element, 'total-attendies', new_value);\n      latepoint_calculate_total_price($booking_form_element);\n    });\n    $('.total-attendies-selector').on('click', function(){\n      var add_value = ($(this).hasClass('total-attendies-selector-plus')) ? 1 : -1;\n      var max_capacity = $(this).closest('.total-attendies-selector-w').data('max-capacity');\n      var min_capacity = $(this).closest('.total-attendies-selector-w').data('min-capacity');\n      var current_value = $(this).closest('.total-attendies-selector-w').find('input.total-attendies-selector-input').val();\n      var new_value = (Number(current_value) > 0) ? Math.max((Number(current_value) + add_value), 1) : 1;\n      new_value = Math.min(Number(max_capacity), new_value);\n      new_value = Math.max(Number(min_capacity), new_value);\n      $(this).closest('.total-attendies-selector-w').find('input').val(new_value).trigger('change');\n      return false;\n    });\n    $('.os-service-category-info').on('click', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      latepoint_show_prev_btn($booking_form_element);\n      $(this).closest('.step-services-w').addClass('selecting-service-category');\n      var $category_wrapper = $(this).closest('.os-service-category-w');\n      var $main_parent = $(this).closest('.os-service-categories-main-parent');\n      if($category_wrapper.hasClass('selected')){\n        $category_wrapper.removeClass('selected');\n        if($category_wrapper.parent().closest('.os-service-category-w').length){\n          $category_wrapper.parent().closest('.os-service-category-w').addClass('selected');\n        }else{\n          $main_parent.removeClass('show-selected-only');\n        }\n      }else{\n        $main_parent.find('.os-service-category-w.selected').removeClass('selected');\n        $main_parent.addClass('show-selected-only');\n        $category_wrapper.addClass('selected');\n      }\n      return false;\n    });\n  }\n\n\n  function latepoint_trigger_next_btn($booking_form_element){\n    $booking_form_element.find('.latepoint_step_direction').val('next');\n    $booking_form_element.find('.latepoint-form').submit();\n  }\n\n  function latepoint_init_step_locations(){\n  }\n\n  function latepoint_init_step_agents(){\n    $('.os-items .os-item-details-btn').on('click', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      var agent_id = $(this).data('agent-id');\n      $booking_form_element.find('.os-agent-bio-popup.active').removeClass('active');\n      $booking_form_element.find('#osAgentBioPopup' + agent_id).addClass('active');\n      return false;\n    });\n    $('.os-agent-bio-close').on('click', function(){\n      $(this).closest('.os-agent-bio-popup').removeClass('active');\n      return false;\n    });\n  }\n\n\n  function latepoint_init_step_confirmation(){\n\n    $('.latepoint-booking-form-element').on('click', '.set-customer-password-btn', function(){\n      var $btn = $(this);\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n\n      $btn.addClass('os-loading');\n      var params = { account_nonse: $('input[name=\"account_nonse\"]').val(), password: $('input[name=\"customer[password]\"]').val(), password_confirmation: $('input[name=\"customer[password_confirmation]\"]').val()}\n      var data = { action: 'latepoint_route_call', route_name: $(this).data('btn-action'), params: $.param(params), layout: 'none', return_format: 'json' }\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          $btn.removeClass('os-loading');\n          if(data.status === \"success\"){\n            $booking_form_element.find('.step-confirmation-set-password').html('').hide();\n            $booking_form_element.find('.confirmation-cabinet-info').show();\n          }else{\n            latepoint_show_message_inside_element(data.message, $booking_form_element.find('.step-confirmation-set-password'), 'error');\n          }\n        }\n      });\n      return false;\n    });\n\n    $('.latepoint-booking-form-element').on('click', '.qr-show-trigger', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_element.find('.qr-code-on-confirmation').addClass('show-vevent-qr-code');\n      return false;\n    });\n\n    $('.latepoint-booking-form-element').on('click', '.show-set-password-fields', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n\n      $booking_form_element.find('.step-confirmation-set-password').show();\n      $booking_form_element.find('#customer_password').focus();\n      $(this).closest('.info-box').hide();\n      return false;\n    });\n  }\n\n\n  function latepoint_init_customer_dashboard_login(){\n    if($('.latepoint-login-form-w #facebook-signin-btn').length && $('.latepoint-login-form-w').length){\n      $('.latepoint-login-form-w #facebook-signin-btn').on('click', function(){\n        var $login_form_wrapper = $(this).closest('.latepoint-login-form-w');\n        FB.login(function(response){\n          if (response.status === 'connected' && response.authResponse) {\n            var params = { token: response.authResponse.accessToken};\n            var data = { action: 'latepoint_route_call', route_name: $login_form_wrapper.find('#facebook-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n            latepoint_step_content_change_start($login_form_wrapper);\n            $.ajax({\n              type : \"post\",\n              dataType : \"json\",\n              url : latepoint_helper.ajaxurl,\n              data : data,\n              success: function(data){\n                if(data.status === \"success\"){\n                  location.reload();\n                }else{\n                  latepoint_show_message_inside_element(data.message, $login_form_wrapper);\n                  latepoint_step_content_change_end(false, $login_form_wrapper);\n                }\n              }\n            });\n          } else {\n            \n          }\n        }, {scope: 'public_profile,email'});\n      });\n    }\n\n    if($('.latepoint-login-form-w #google-signin-btn').length && $('.latepoint-login-form-w').length && typeof gapi !== 'undefined'){\n      // INIT GOOGLE LOGIN\n      var googleUser = {};\n\n      var $login_form_wrappers = $('.latepoint-login-form-w');\n      $login_form_wrappers.each(function(){\n        var $login_form_wrapper = $(this);\n        gapi.load('auth2', function(){\n          // Retrieve the singleton for the GoogleAuth library and set up the client.\n          var auth2 = gapi.auth2.init({\n            client_id: $login_form_wrapper.find('meta[name=google-signin-client_id]').attr(\"content\"),\n            cookiepolicy: 'single_host_origin',\n            // Request scopes in addition to 'profile' and 'email'\n            //scope: 'additional_scope'\n          });\n\n          auth2.attachClickHandler($login_form_wrapper.find('#google-signin-btn')[0], {},\n            function(googleUser) {\n              var params = { token: googleUser.getAuthResponse().id_token};\n              var data = { action: 'latepoint_route_call', route_name: $login_form_wrapper.find('#google-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n              latepoint_step_content_change_start($login_form_wrapper);\n              $.ajax({\n                type : \"post\",\n                dataType : \"json\",\n                url : latepoint_helper.ajaxurl,\n                data : data,\n                success: function(data){\n                  if(data.status === \"success\"){\n                    location.reload();\n                  }else{\n                    latepoint_show_message_inside_element(data.message, $login_form_wrapper);\n                    latepoint_step_content_change_end(false, $login_form_wrapper);\n                  }\n                }\n              });\n            }, function(error) {\n              // console.log(JSON.stringify(error, undefined, 2));\n            });\n        });\n      });\n    }\n  }\n\n  function get_customer_name($wrapper){\n    var customer_name = '';\n    var first_name = $wrapper.find('input[name=\"customer[first_name]\"]').val();\n    var last_name = $wrapper.find('input[name=\"customer[last_name]\"]').val();\n    if(first_name) customer_name+= first_name;\n    if(last_name) customer_name+= ' ' + last_name;\n    return customer_name.trim();\n  }\n\n  function latepoint_init_step_contact(){\n    latepoint_init_facebook_login();\n    latepoint_init_google_login();\n    latepoint_init_form_masks();\n\n    $('.step-contact-w').each(function(){\n      latepoint_update_summary_field($(this).closest('.latepoint-booking-form-element'), 'customer', get_customer_name($(this)));\n    });\n\n    $('.step-contact-w').on('keyup', 'input[name=\"customer[first_name]\"], input[name=\"customer[last_name]\"]', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      latepoint_update_summary_field($booking_form_element, 'customer', get_customer_name($booking_form_element));\n    });\n\n    $('.step-contact-w').on('keyup', '.os-form-control.required', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      if(latepoint_validate_fields($booking_form_element.find('.step-contact-w .os-form-control.required'))){\n      }else{\n      }\n    });\n\n    // Init Logout button\n    $('.step-customer-logout-btn').on('click', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      var data = { action: 'latepoint_route_call', route_name: $(this).data('btn-action'), layout: 'none', return_format: 'json' }\n      latepoint_step_content_change_start($booking_form_element);\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          latepoint_reload_step($booking_form_element);\n        }\n      });\n      return false;\n    });\n\n    // Init Login Existing Customer Button\n    $('.step-login-existing-customer-btn').on('click', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      var params = { email: $booking_form_element.find('.os-step-existing-customer-login-w input[name=\"customer_login[email]\"]').val(), password: $booking_form_element.find('.os-step-existing-customer-login-w input[name=\"customer_login[password]\"]').val()}\n      var data = { action: 'latepoint_route_call', route_name: $(this).data('btn-action'), params: $.param(params), layout: 'none', return_format: 'json' }\n      latepoint_step_content_change_start($booking_form_element);\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n            if(data.status === \"success\"){\n              latepoint_reload_step($booking_form_element);\n            }else{\n              latepoint_show_message_inside_element(data.message, $booking_form_element.find('.os-step-existing-customer-login-w'));\n              latepoint_step_content_change_end(false, $booking_form_element);\n            }\n        }\n      });\n      return false;\n    });\n  }\n\n  function latepoint_step_content_change_start($booking_form_element){\n    $booking_form_element.removeClass('step-content-loaded').addClass('step-content-loading');\n  }\n\n  // TODO\n  function latepoint_step_content_change_end(new_content, $booking_form_element){\n    if(new_content) $booking_form_element.find('.latepoint-body .latepoint-step-content').replaceWith(new_content);\n    $booking_form_element.removeClass('step-content-loading').addClass('step-content-mid-loading');\n    setTimeout(function(){\n      $booking_form_element.removeClass('step-content-mid-loading').addClass('step-content-loaded');\n    }, 50);\n  }\n\n  function latepoint_init_facebook_login(){\n    if(!$('#facebook-signin-btn').length || !$('.latepoint-booking-form-element').length) return;\n    $('#facebook-signin-btn').on('click', function(){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      FB.login(function(response){\n        if (response.status === 'connected' && response.authResponse) {\n          var params = { token: response.authResponse.accessToken};\n          var data = { action: 'latepoint_route_call', route_name: $booking_form_element.find('#facebook-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n          latepoint_step_content_change_start($booking_form_element);\n          $.ajax({\n            type : \"post\",\n            dataType : \"json\",\n            url : latepoint_helper.ajaxurl,\n            data : data,\n            success: function(data){\n              if(data.status === \"success\"){\n                latepoint_reload_step($booking_form_element);\n              }else{\n                latepoint_show_message_inside_element(data.message, $booking_form_element.find('.os-step-existing-customer-login-w '));\n                latepoint_step_content_change_end(false, $booking_form_element);\n              }\n            }\n          });\n        } else {\n          \n        }\n      }, {scope: 'public_profile,email'});\n    });\n  }\n\n  function latepoint_init_google_login(){\n    if(!$('#google-signin-btn').length || !$('.latepoint-booking-form-element').length || typeof gapi === 'undefined') return;\n    var googleUser = {};\n\n    var $booking_form_elements = $('.latepoint-booking-form-element');\n    $booking_form_elements.each(function(){\n      var $booking_form_element = $(this);\n      gapi.load('auth2', function(){\n        // Retrieve the singleton for the GoogleAuth library and set up the client.\n        var auth2 = gapi.auth2.init({\n          client_id: $booking_form_element.find('meta[name=google-signin-client_id]').attr(\"content\"),\n          cookiepolicy: 'single_host_origin',\n          // Request scopes in addition to 'profile' and 'email'\n          //scope: 'additional_scope'\n        });\n\n        auth2.attachClickHandler($booking_form_element.find('#google-signin-btn')[0], {},\n          function(googleUser) {\n            var params = { token: googleUser.getAuthResponse().id_token};\n            var data = { action: 'latepoint_route_call', route_name: $booking_form_element.find('#google-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n            latepoint_step_content_change_start($booking_form_element);\n            $.ajax({\n              type : \"post\",\n              dataType : \"json\",\n              url : latepoint_helper.ajaxurl,\n              data : data,\n              success: function(data){\n                if(data.status === \"success\"){\n                  latepoint_reload_step($booking_form_element);\n                }else{\n                  latepoint_show_message_inside_element(data.message, $booking_form_element.find('.os-step-existing-customer-login-w '));\n                  latepoint_step_content_change_end(false, $booking_form_element);\n                }\n              }\n            });\n          }, function(error) {\n            // console.log(JSON.stringify(error, undefined, 2));\n          });\n      });\n    });\n  }\n\n  function latepoint_change_step_desc($booking_form_element, step_name){\n    $booking_form_element.removeClass('step-changed').addClass('step-changing');\n    setTimeout(function(){\n      // Progress bar\n      var $step_progress = $booking_form_element.find('.latepoint-progress li[data-step-name=\"' + step_name + '\"]');\n      $step_progress.addClass('active').addClass('complete').prevAll().addClass('complete').removeClass('active');\n      $step_progress.nextAll().removeClass('complete').removeClass('active');\n      // Side panel\n      var side_panel_desc = $booking_form_element.find('.latepoint-step-desc-library[data-step-name=\"' + step_name + '\"]').html();\n      $booking_form_element.find('.latepoint-step-desc').html(side_panel_desc);\n\n      // Top header\n      var top_header_desc = $booking_form_element.find('.os-heading-text-library[data-step-name=\"' + step_name + '\"]').html();\n      $booking_form_element.find('.os-heading-text').html(top_header_desc);\n      setTimeout(function(){\n          $booking_form_element.removeClass('step-changing').addClass('step-changed');\n      }, 50);\n    }, 500);\n  }\n\n\n  function latepoint_progress_prev($booking_form_element, step_name){\n    var $step_progress = $booking_form_element.find('.latepoint-progress li[data-step-name=\"' + step_name + '\"]');\n    $step_progress.addClass('active').addClass('complete').prevAll().addClass('complete').removeClass('active');\n    $step_progress.nextAll().removeClass('complete').removeClass('active');\n  }\n\n\n  function latepoint_progress_next($booking_form_element, step_name){\n    var $step_progress = $booking_form_element.find('.latepoint-progress li[data-step-name=\"' + step_name + '\"]');\n    $step_progress.addClass('active').addClass('complete').prevAll().addClass('complete').removeClass('active');\n    $step_progress.nextAll().removeClass('complete').removeClass('active');\n  }\n\n\n  function latepoint_next_step_description($booking_form_element, step_name){\n    $booking_form_element.removeClass('step-changed').addClass('step-changing');\n    setTimeout(function(){\n      $booking_form_element.find('.latepoint-step-desc').html($booking_form_element.find('.latepoint-step-desc-library.active').removeClass('active').next('.latepoint-step-desc-library').addClass('active').html());\n      $booking_form_element.find('.os-heading-text').html($booking_form_element.find('.os-heading-text-library.active').removeClass('active').next('.os-heading-text-library').addClass('active').html());\n      setTimeout(function(){\n        $booking_form_element.removeClass('step-changing').addClass('step-changed');\n      }, 50);\n    }, 500);\n  }\n  function latepoint_prev_step_description($booking_form_element, step_name){\n    $booking_form_element.removeClass('step-changed').addClass('step-changing');\n    setTimeout(function(){\n      $booking_form_element.find('.latepoint-step-desc').html($booking_form_element.find('.latepoint-step-desc-library.active').removeClass('active').prev('.latepoint-step-desc-library').addClass('active').html());\n      $booking_form_element.find('.os-heading-text').html($booking_form_element.find('.os-heading-text-library.active').removeClass('active').prev('.os-heading-text-library').addClass('active').html());\n      setTimeout(function(){\n        $booking_form_element.removeClass('step-changing').addClass('step-changed');\n      }, 50);\n    }, 500);\n  }\n\n\n  function latepoint_validate_fields($fields){\n    var is_valid = true;\n    $fields.each(function(index){\n      if($(this).val() == ''){\n        is_valid = false;\n        return false;\n      }\n    });\n    return is_valid;\n  }\n\n  function latepoint_submit_booking_form($booking_form){\n    var $booking_form_element = $booking_form.closest('.latepoint-booking-form-element');\n    var form_data = $booking_form.serialize();\n    var data = { action: 'latepoint_route_call', route_name: $booking_form.data('route-name'), params: form_data, layout: 'none', return_format: 'json'}\n    $booking_form_element.removeClass('step-content-loaded').addClass('step-content-loading');\n    $.ajax({\n      type : \"post\",\n      dataType : \"json\",\n      url : latepoint_helper.ajaxurl,\n      data : data,\n      success: function(data){\n        if(data.status === \"success\"){\n          latepoint_hide_message_inside_element($booking_form_element.find('.latepoint-body'));\n          if($booking_form_element.data('flash-error')){\n            latepoint_show_message_inside_element($booking_form_element.data('flash-error'), $booking_form_element.find('.latepoint-body'));\n            $booking_form_element.data('flash-error', '');\n          }\n          $booking_form_element.find('.latepoint_current_step').val(data.step_name);\n          $booking_form_element.removeClass(function (index, className) { return (className.match (/(^|\\s)current-step-\\S+/g) || []).join(' '); }).addClass('current-step-' + data.step_name);\n          setTimeout(function(){\n            $booking_form_element.removeClass('step-content-loading').addClass('step-content-mid-loading');\n            $booking_form_element.find('.latepoint-body').find('.latepoint-step-content').addClass('is-hidden');\n            if($booking_form_element.find('.latepoint-step-content[data-step-name=\"'+ data.step_name +'\"]')){\n              $booking_form_element.find('.latepoint-step-content[data-step-name=\"'+ data.step_name +'\"]').remove();\n            }\n            $booking_form_element.find('.latepoint-body').append(data.message);\n\n            latepoint_init_step(data.step_name, $booking_form_element);\n            setTimeout(function(){\n              $booking_form_element.removeClass('step-content-mid-loading').addClass('step-content-loaded');\n              $booking_form_element.find('.latepoint-next-btn, .latepoint-prev-btn').removeClass('os-loading');\n            }, 50);\n          }, 500);\n\n          if(data.is_pre_last_step){\n            $booking_form_element.data('next-submit-is-last', 'yes');\n            $booking_form_element.find('.latepoint-next-btn span').text($booking_form_element.find('.latepoint-next-btn').data('pre-last-step-label'));\n          }else{\n            $booking_form_element.data('next-submit-is-last', 'no');\n            $booking_form_element.find('.latepoint-next-btn span').text($booking_form_element.find('.latepoint-next-btn').data('label'));\n          }\n          if(data.is_last_step){\n            $booking_form_element.addClass('hidden-buttons').find('.latepoint-footer').remove();\n            $booking_form_element.find('.latepoint-progress').css( 'opacity', 0 );\n            $booking_form_element.closest('.latepoint-summary-is-open').removeClass('latepoint-summary-is-open');\n            $booking_form_element.addClass('is-final-step');\n          }else{\n            if(data.show_next_btn === true){\n              latepoint_show_next_btn($booking_form_element);\n            }else{\n              latepoint_hide_next_btn($booking_form_element);\n            }\n            if(data.show_prev_btn === true){\n              latepoint_show_prev_btn($booking_form_element);\n            }else{\n              latepoint_hide_prev_btn($booking_form_element);\n            }\n          }\n          latepoint_change_step_desc($booking_form_element, data.step_name);\n        }else{\n          $booking_form_element.removeClass('step-content-loading').addClass('step-content-loaded');\n          $booking_form_element.find('.latepoint-next-btn, .latepoint-prev-btn').removeClass('os-loading');\n          if(data.send_to_step && $booking_form_element.find('.latepoint-step-content[data-step-name=\"'+ data.send_to_step +'\"]').length){\n            $booking_form_element.data('flash-error', data.message);\n            latepoint_reload_step($booking_form_element, data.send_to_step);\n          }else{\n            latepoint_show_message_inside_element(data.message, $booking_form_element.find('.latepoint-body'));\n            latepoint_show_prev_btn($booking_form_element);\n          }\n        }\n        $booking_form.find('.latepoint_step_direction').val('next');\n      }\n    });\n  }\n\n  function latepoint_init_booking_form(){\n\n    $('.latepoint-booking-form-element .latepoint-form').on('submit', function(e){\n      e.preventDefault();\n      var $booking_form = $(this);\n      var $booking_form_element = $booking_form.closest('.latepoint-booking-form-element');\n      latepoint_hide_prev_btn($booking_form_element);\n      var current_step = $booking_form_element.find('.latepoint_current_step').val();\n      var callbacks_list = [];\n      $booking_form_element.trigger('latepoint:submitBookingForm', [{ current_step: current_step, \n                                                                      callbacks_list: callbacks_list, \n                                                                      is_final_submit: $booking_form_element.data('next-submit-is-last') == 'yes',\n                                                                      direction: $booking_form_element.find('.latepoint_step_direction').val()}]);\n      jQuery.when(...callbacks_list.map(callback => callback.action()))\n        .done(() => {\n                      latepoint_submit_booking_form($booking_form);\n                    })\n        .fail((error) => {\n          if(error.send_to_step && $booking_form_element.find('.latepoint-step-content[data-step-name=\"'+ error.send_to_step +'\"]').length){\n            latepoint_reload_step($booking_form_element, error.send_to_step);\n          }\n          $booking_form_element.removeClass('step-content-loading').addClass('step-content-loaded');\n          latepoint_show_message_inside_element(error.message, $booking_form_element.find('.latepoint-body'), 'error');\n          $booking_form_element.find('.latepoint-next-btn').removeClass('os-loading');\n          if($booking_form_element.find('.latepoint-step-content:last-child').prev('.latepoint-step-content').length) latepoint_show_prev_btn($booking_form_element);\n        });\n    });\n\n    $('.latepoint-lightbox-close').on('click', function(){\n      $('body').removeClass('latepoint-lightbox-active');\n      $('.latepoint-lightbox-w').remove();\n      return false;\n    });\n\n\n\n    $('.latepoint-customer-timezone-selector-w select').on('change', function(e){\n      var $select_box = $(this);\n      $select_box.closest('.latepoint-customer-timezone-selector-w').addClass('os-loading');\n      var data = { action: 'latepoint_route_call', route_name: $(this).closest('.latepoint-customer-timezone-selector-w').data('route-name'), params: { timezone_name: $(this).val()}, layout: 'none', return_format: 'json'}\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          $select_box.closest('.latepoint-customer-timezone-selector-w').removeClass('os-loading');\n          if(data.status === \"success\"){\n            location.reload();\n          }else{\n\n          }\n        }\n      });\n    });\n\n    $('.latepoint-timezone-selector-w select').on('change', function(e){\n      var $select_box = $(this);\n      $select_box.closest('.latepoint-timezone-selector-w').addClass('os-loading');\n      var data = { action: 'latepoint_route_call', route_name: $(this).closest('.latepoint-timezone-selector-w').data('route-name'), params: { timezone_name: $(this).val()}, layout: 'none', return_format: 'json'}\n      var $booking_form_element = $select_box.closest('.latepoint-booking-form-element');\n      $booking_form_element.removeClass('step-content-loaded').addClass('step-content-loading');\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          $select_box.closest('.latepoint-timezone-selector-w').removeClass('os-loading');\n          $booking_form_element.removeClass('step-content-loading');\n          if(data.status === \"success\"){\n            // reload datepicker if its the step\n            if($select_box.closest('.latepoint-booking-form-element').hasClass('current-step-datepicker')){\n              latepoint_reload_step($select_box.closest('.latepoint-booking-form-element'));\n            }\n          }else{\n\n          }\n        }\n      });\n    });\n\n    if(!latepoint_helper.is_timezone_selected){\n      const tzid = Intl.DateTimeFormat().resolvedOptions().timeZone;\n      if(tzid){\n        if(tzid != $('.latepoint-timezone-selector-w select').val()) $('.latepoint-timezone-selector-w select').val(tzid).change();\n      }\n    }\n\n    \n\n    $('.latepoint-booking-form-element').on('click', '.lp-option', function(){\n      $(this).closest('.lp-options').find('.lp-option.selected').removeClass('selected');\n      $(this).addClass('selected');\n    });\n\n\n\n\n    // Next Step button Click\n    $('.latepoint-booking-form-element .latepoint-next-btn').on('click', function(e){\n      if($(this).hasClass('disabled') || $(this).hasClass('os-loading')) return false;\n      var $next_btn = $(this); \n      $next_btn.addClass('os-loading');\n      var $booking_form = $(this).closest('.latepoint-form');\n      var $booking_form_element = $booking_form.closest('.latepoint-booking-form-element');\n\n      var current_step = $booking_form_element.find('.latepoint_current_step').val();\n\n      $booking_form.find('.latepoint_step_direction').val('next');\n      var callbacks_list = [];\n      $booking_form_element.trigger('latepoint:nextStepClicked', [{current_step: current_step, callbacks_list: callbacks_list}]);\n      latepoint_hide_prev_btn($booking_form_element);\n      jQuery.when(...callbacks_list.map(callback => callback.action()))\n        .done(() => {\n                      $booking_form.submit();\n                    })\n        .fail((error) => {\n          latepoint_show_message_inside_element(error.message, $booking_form_element.find('.latepoint-body'), 'error');\n          $next_btn.removeClass('os-loading');\n          // if previous step exists - show prev button\n          if($booking_form_element.find('.latepoint-step-content:last-child').prev('.latepoint-step-content').length) latepoint_show_prev_btn($booking_form_element);\n        });\n      return false;\n    });\n\n\n    // Previous Step button Click\n    $('.latepoint-booking-form-element .latepoint-prev-btn').on('click', function(e){\n      if($(this).hasClass('disabled') || $(this).hasClass('os-loading')) return false;\n      var $booking_form = $(this).closest('.latepoint-form');\n      var $booking_form_element = $booking_form.closest('.latepoint-booking-form-element');\n\n      var current_step = $booking_form_element.find('.latepoint_current_step').val();\n\n      if(current_step == 'locations'){\n      }\n      if(current_step == 'agents'){\n      }\n      if(current_step == 'payment'){\n        var $payment_step = $booking_form_element.find('.step-payment-w');\n        if($payment_step.length){\n          $payment_step.find('.lp-option.selected').removeClass('selected');\n          var new_sub_step = latepoint_get_payment_sub_step($booking_form_element, $payment_step.attr('data-sub-step'), true);\n          // hide all payment method content blocks\n          if(new_sub_step != $payment_step.attr('data-sub-step')){\n            $payment_step.find('.lp-payment-method-content').hide();\n            $payment_step.attr('data-sub-step', new_sub_step);\n            latepoint_hide_next_btn($booking_form_element);\n            return false;\n          }\n        }\n      }\n      if(current_step == 'services'){\n        var $services_step = $booking_form_element.find('.step-services-w');\n        if($services_step.hasClass('selecting-service-duration')){\n          $services_step.removeClass('selecting-service-duration');\n          $services_step.find('.os-services > .os-item.selected').removeClass('selected');\n          clear_sub_step_duration($booking_form_element);\n          if(($booking_form_element.find('.latepoint-step-content').length <= 1) && !$services_step.hasClass('selecting-service-category')){\n            latepoint_hide_prev_btn($booking_form_element)\n          }\n          latepoint_calculate_total_price($booking_form_element);\n          return false;\n        }\n        if($services_step.hasClass('selecting-total-attendies')){\n          $services_step.removeClass('selecting-total-attendies');\n          if($services_step.find('.os-services > .os-item.selected').hasClass('has-multiple-durations')){\n            // multiple durations\n            $services_step.find('.os-services > .os-item.selected .os-service-durations .os-selectable-item.selected').removeClass('selected');\n            $services_step.addClass('selecting-service-duration');\n            latepoint_hide_next_btn($booking_form_element);\n          }else{\n            $services_step.find('.os-services > .os-item.selected').removeClass('selected');\n          }\n          clear_sub_step_attendies($booking_form_element);\n          if(($booking_form_element.find('.latepoint-step-content').length <= 1) && !$services_step.hasClass('selecting-service-category')){\n            latepoint_hide_prev_btn($booking_form_element)\n          }\n          latepoint_calculate_total_price($booking_form_element);\n          return false;\n        }\n        if($services_step.hasClass('selecting-service-category')){\n          if($services_step.find('.os-service-category-w .os-service-category-w.selected').length){\n            $services_step.find('.os-service-category-w .os-service-category-w.selected').parents('.os-service-category-w').addClass('selected').find('.os-service-category-w.selected').removeClass('selected');\n          }else{\n            $services_step.removeClass('selecting-service-category').find('.os-service-category-w.selected').removeClass('selected');\n            $services_step.removeClass('selecting-service-category').find('.os-service-categories-holder.show-selected-only').removeClass('show-selected-only');\n          }\n          if(($booking_form_element.find('.latepoint-step-content').length <= 1) && !$services_step.hasClass('selecting-service-category')){\n            latepoint_hide_prev_btn($booking_form_element);\n          }\n          latepoint_calculate_total_price($booking_form_element);\n          return false;\n        }\n      }\n\n      var $current_active_step = $booking_form_element.find('.latepoint-step-content:last-child');\n      if($current_active_step.data('clear-action')){\n        window[$current_active_step.data('clear-action')]($booking_form_element);\n      }\n\n      var $back_btn = $(this);\n      $back_btn.addClass('os-loading');\n      $booking_form_element.removeClass('step-content-loaded').addClass('step-content-loading');\n      var $new_current_step = $booking_form_element.find('.latepoint-step-content.is-hidden').last();\n      var new_current_step_name = $new_current_step.data('step-name');\n      latepoint_change_step_desc($booking_form_element, new_current_step_name);\n      setTimeout(function(){\n        $new_current_step.removeClass('is-hidden');\n        $current_active_step.remove();\n        $booking_form_element.find('.latepoint_current_step').val(new_current_step_name);\n        $booking_form_element.find('.latepoint-next-btn span').text($booking_form_element.find('.latepoint-next-btn').data('label'));\n        $booking_form_element.data('next-submit-is-last', 'no');\n        latepoint_show_next_btn($booking_form_element);\n        $back_btn.removeClass('os-loading');\n        if($booking_form_element.find('.latepoint-step-content').length <= 1){\n          if(new_current_step_name == 'services'){\n            var $services_step = $booking_form_element.find('.step-services-w');\n            if($services_step.hasClass('selecting-service-duration') || $services_step.hasClass('selecting-total-attendies') || $services_step.hasClass('selecting-service-category')){\n              if($services_step.find('.os-services > .os-item.selected').hasClass('is-preselected')){\n                // if service is preselected check if there are both multiple duraitons and quantity selector and only then show prev button\n                if($services_step.hasClass('selecting-total-attendies') && $services_step.find('.os-services > .os-item.selected').hasClass('has-multiple-durations')){\n                  // if selecting attendies and there are multiple durations - show prev button\n                  latepoint_show_prev_btn($booking_form_element);\n                }else{\n                  latepoint_hide_prev_btn($booking_form_element);\n                }\n              }else{\n                latepoint_show_prev_btn($booking_form_element);\n              }\n            }else{\n              latepoint_hide_prev_btn($booking_form_element);\n            }\n          }else{\n            latepoint_hide_prev_btn($booking_form_element);\n          }\n        }\n        $booking_form_element.removeClass('step-content-loading').addClass('step-content-mid-loading');\n        setTimeout(function(){\n          $booking_form_element.removeClass('step-content-mid-loading').addClass('step-content-loaded');\n          latepoint_hide_message_inside_element($booking_form_element.find('.latepoint-body'));\n          latepoint_calculate_total_price($booking_form_element);\n        }, 150);\n      }, 700);\n      return false;\n    });\n  }\n\n  // DOCUMENT READY\n  $( function() {\n\n    latepoint_init_customer_dashboard_login();\n\n    if($('.latepoint-booking-form-element').length){\n      latepoint_init_booking_form();\n      $('.latepoint-booking-form-element').each(function(){\n        latepoint_init_step($(this).find('.latepoint_current_step').val(), $(this));\n      });\n    }\n\n    $('.latepoint-request-booking-cancellation').on('click', function(){\n      if(!confirm(latepoint_helper.cancel_booking_prompt)) return false;\n      var $this = $(this);\n      var $booking_box = $this.closest('.customer-booking');\n\n      var route = $(this).data('route');\n      var params = {id: $booking_box.data('id')};\n\n      var data = { action: 'latepoint_route_call', route_name: route, params: params, layout: 'none', return_format: 'json' }\n      $this.addClass('os-loading');\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          if(data.status === \"success\"){\n            location.reload();\n            $this.remove();\n          }else{\n            $this.removeClass('os-loading');\n          }\n        }\n      });\n      return false;\n    });\n\n\n    $('body').on('click', '.os-step-tabs .os-step-tab', function(){\n      $(this).closest('.os-step-tabs').find('.os-step-tab').removeClass('active');\n      $(this).addClass('active');\n      var target = $(this).data('target');\n      $(this).closest('.os-step-tabs-w').find('.os-step-tab-content').hide();\n      $(target).show();\n    });\n\n    $('body').on('keyup', '.os-form-group .os-form-control', function(){\n      if($(this).val()){\n        $(this).closest('.os-form-group').addClass('has-value');\n      }else{\n        $(this).closest('.os-form-group').removeClass('has-value');\n      }\n    });\n\n    $('.latepoint-tab-triggers').on('click', '.latepoint-tab-trigger', function(){\n      var $tabs_wrapper = $(this).closest('.latepoint-tabs-w')\n      $tabs_wrapper.find('.latepoint-tab-trigger.active').removeClass('active');\n      $tabs_wrapper.find('.latepoint-tab-content').removeClass('active');\n      $(this).addClass('active');\n      $tabs_wrapper.find('.latepoint-tab-content' + $(this).data('tab-target')).addClass('active');\n      return false;\n    });\n\n\n    // Main Button to trigger lightbox opening\n    $('.latepoint-book-button, .os_trigger_booking').on('click', function(){\n      var $this = $(this);\n      var $booking_form_element = $this.closest('.latepoint-booking-form-element');\n      var route = latepoint_helper.booking_button_route;\n      var params = {};\n      var restrictions = {};\n      if($this.data('show-service-categories')) restrictions.show_service_categories = $this.data('show-service-categories');\n      if($this.data('show-locations')) restrictions.show_locations = $this.data('show-locations');\n      if($this.data('show-services')) restrictions.show_services = $this.data('show-services');\n      if($this.data('show-agents')) restrictions.show_agents = $this.data('show-agents');\n      if($this.data('selected-location')) restrictions.selected_location = $this.data('selected-location');\n      if($this.data('selected-agent')) restrictions.selected_agent = $this.data('selected-agent');\n      if($this.data('selected-service')) restrictions.selected_service = $this.data('selected-service');\n      if($this.data('selected-service-category')) restrictions.selected_service_category = $this.data('selected-service-category');\n      if($this.data('selected-start-date')) restrictions.selected_start_date = $this.data('selected-start-date');\n      if($this.data('selected-start-time')) restrictions.selected_start_time = $this.data('selected-start-time');\n      if($this.data('calendar-start-date')) restrictions.calendar_start_date = $this.data('calendar-start-date');\n\n      if($.isEmptyObject(restrictions) == false) params.restrictions = restrictions;\n\n      var data = { action: 'latepoint_route_call', route_name: route, params: params, layout: 'none', return_format: 'json' }\n      $this.addClass('os-loading');\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          if(data.status === \"success\"){\n            var lightbox_class = '';\n            if($this.data('hide-summary') != 'yes') lightbox_class+= ' latepoint-with-summary';\n            if($this.data('hide-side-panel') == 'yes') lightbox_class+= ' latepoint-hide-side-panel';\n            latepoint_show_data_in_lightbox(data.message, lightbox_class);\n            latepoint_init_booking_form();\n            latepoint_init_step(data.step, $booking_form_element);\n            $('body').addClass('latepoint-lightbox-active');\n            $this.removeClass('os-loading');\n            \n          }else{\n            $this.removeClass('os-loading');\n            // console.log(data.message);\n          }\n        }\n      });\n\n      return false;\n    });\n\n\n\n  });\n\n\n} )( jQuery );\n"]}