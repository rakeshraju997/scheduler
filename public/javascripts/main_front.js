"use strict";function latepoint_is_timeframe_in_periods(t,e,a,n){for(var s=arguments.length>3&&void 0!==n&&n,o=0;o<a.length;o++){var i=0,l=0,r=0,d=0,p=a[o].split(":");if(2==p.length?(i=p[0],l=p[1]):(r=p[2],d=p[3],i=parseFloat(p[0])-parseFloat(r),l=parseFloat(p[1])+parseFloat(d)),s){if(latepoint_is_period_inside_another(t,e,i,l))return!0}else if(latepoint_is_period_overlapping(t,e,i,l))return!0}return!1}function latepoint_is_period_overlapping(t,e,a,n){return t<n&&a<e}function latepoint_is_period_inside_another(t,e,a,n){return t>=a&&e<=n}function latepoint_minutes_to_hours_preferably(t){var e=latepoint_is_army_clock(),a=Math.floor(t/60);!e&&a>12&&(a-=12);var n=t%60;return n>0&&(a=a+":"+n),a}function latepoint_minutes_to_hours(t){var e=latepoint_is_army_clock(),a=Math.floor(t/60);return!e&&a>12&&(a-=12),a}function latepoint_am_or_pm(t){return latepoint_is_army_clock()?"":t<720?"am":"pm"}function latepoint_hours_and_minutes_to_minutes(t,e){var a=t.split(":"),n=a[0],s=a[1];return"pm"==e&&n<12&&(n=parseInt(n)+12),"am"==e&&12==n&&(n=0),s=parseInt(s)+60*n}function latepoint_get_time_system(){return latepoint_helper.time_system}function latepoint_is_army_clock(){return"24"==latepoint_get_time_system()}function latepoint_minutes_to_hours_and_minutes(t,e){var a=latepoint_is_army_clock(),n=arguments.length>1&&void 0!==e?e:"%02d:%02d",s=Math.floor(t/60);!a&&s>12&&(s-=12);var o=t%60;return sprintf(n,s,o)}function latepoint_mask_timefield(t){jQuery().inputmask&&t.inputmask({mask:"99:99",placeholder:"HH:MM"})}function latepoint_mask_phone(t){latepoint_is_phone_masking_enabled()&&jQuery().inputmask&&t.inputmask(latepoint_get_phone_format())}function latepoint_get_phone_format(){return latepoint_helper.phone_format}function latepoint_is_phone_masking_enabled(){return"yes"==latepoint_helper.enable_phone_masking}function latepoint_show_booking_end_time(){return"yes"==latepoint_helper.show_booking_end_time}function latepoint_init_form_masks(){latepoint_is_phone_masking_enabled()&&latepoint_mask_phone(jQuery(".os-mask-phone"))}function latepoint_get_paypal_payment_amount(t){var e,a;return"deposit"==t.find('input[name="booking[payment_portion]"]').val()?t.find(".lp-paypal-btn-trigger").data("deposit-amount"):t.find(".lp-paypal-btn-trigger").data("full-amount")}function latepoint_add_notification(t,e){var a=arguments.length>1&&void 0!==e?e:"success",n=jQuery("body").find(".os-notifications");n.length||(jQuery("body").append('<div class="os-notifications"></div>'),n=jQuery("body").find(".os-notifications")),n.find(".item").length>0&&n.find(".item:first-child").remove(),n.append('<div class="item item-type-'+a+'">'+t+'<span class="os-notification-close"><i class="latepoint-icon latepoint-icon-x"></i></span></div>')}function latepoint_generate_form_message_html(t,e){var a='<div class="os-form-message-w status-'+e+'"><ul>';return Array.isArray(t)?t.forEach((function(t){a+="<li>"+t+"</li>"})):a+="<li>"+t+"</li>",a+="</ul></div>"}function latepoint_clear_form_messages(t){t.find(".os-form-message-w").remove()}function latepoint_show_data_in_lightbox(t,e){var a=arguments.length>1&&void 0!==e?e:"";jQuery(".latepoint-lightbox-w").remove();var n="latepoint-lightbox-w latepoint-w ";a&&(n+=a),jQuery("body").append('<div class="'+n+'"><div class="latepoint-lightbox-i">'+t+'<a href="#" class="latepoint-lightbox-close"><i class="latepoint-icon latepoint-icon-x"></i></a></div><div class="latepoint-lightbox-shadow"></div></div>'),jQuery("body").addClass("latepoint-lightbox-active")}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function latepoint_init_payment_method_actions(t,e){var a,n=[],s="yes"==t.data("next-submit-is-last");t.trigger("latepoint:initPaymentMethod",[{payment_method:e,callbacks_list:n,is_last_step:s}]),t.removeClass("step-content-loaded").addClass("step-content-loading"),(a=jQuery).when.apply(a,_toConsumableArray(n.map((function(t){return t.action()})))).done((function(){t.removeClass("step-content-loading").addClass("step-content-loaded").find('.lp-payment-method-content[data-payment-method="'+e+'"]').show()}))}function latepoint_show_next_btn(t){t.find(".latepoint-next-btn").removeClass("disabled"),t.removeClass("hidden-buttons")}function clear_step_services(t){latepoint_update_summary_field(t,"service",""),clear_sub_step_attendies(t)}function clear_sub_step_attendies(t){t.find(".latepoint_total_attendies").val(1),latepoint_update_summary_field(t,"total-attendies",""),clear_sub_step_duration(t)}function clear_sub_step_duration(t){t.find(".latepoint_duration").val(""),latepoint_update_summary_field(t,"duration","")}function clear_step_service_extras(t){latepoint_update_summary_field(t,"service-extras","")}function clear_step_locations(t){latepoint_update_summary_field(t,"location","")}function clear_step_agents(t){latepoint_update_summary_field(t,"agent","")}function clear_step_datepicker(t){latepoint_update_summary_field(t,"time",""),latepoint_update_summary_field(t,"date","")}function latepoint_hide_next_btn(t){t.find(".latepoint-next-btn").addClass("disabled"),t.find(".latepoint-prev-btn.disabled").length&&t.addClass("hidden-buttons")}function latepoint_show_prev_btn(t){t.find(".latepoint-prev-btn").removeClass("disabled"),t.removeClass("hidden-buttons")}function latepoint_hide_prev_btn(t){t.find(".latepoint-prev-btn").addClass("disabled"),t.find(".latepoint-next-btn.disabled").length&&t.addClass("hidden-buttons")}function latepoint_show_capacity_selector(t){var e=t.closest(".latepoint-booking-form-element"),a=t.data("max-capacity"),n=t.data("min-capacity");e.find(".sta-sub-label span").text(a),e.find(".step-services-w").removeClass("selecting-service-duration"),e.find(".total-attendies-selector-w").data("max-capacity",a),e.find(".total-attendies-selector-w").data("min-capacity",n),t.closest(".step-services-w").addClass("selecting-total-attendies"),e.find(".total-attendies-selector-input").val(n),latepoint_show_prev_btn(e),latepoint_show_next_btn(e)}function latepoint_show_durations(t){var e=t.closest(".latepoint-booking-form-element");t.closest(".step-services-w").addClass("selecting-service-duration"),latepoint_show_prev_btn(e),latepoint_hide_next_btn(e)}function latepoint_apply_coupon(t){var e=t.closest(".latepoint-booking-form-element"),a=t;a.closest(".coupon-code-input-w").addClass("os-loading");var n=e.find(".latepoint-form").serialize(),s={action:"latepoint_route_call",route_name:t.data("route"),params:n,layout:"none",return_format:"json"};jQuery.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:s,success:function t(n){a.closest(".coupon-code-input-w").removeClass("os-loading"),"success"===n.status?(e.find('input[name="booking[coupon_code]"]').val(a.val()),latepoint_show_message_inside_element(n.message,e.find(".latepoint-body"),"success"),e.find('.step-payment-w input[name="booking[payment_method]"]').val(""),e.find('input[name="booking[payment_token]"]').val(""),e.find('input[name="booking[payment_portion]"]').val(""),latepoint_reload_step(e)):latepoint_show_message_inside_element(n.message,e.find(".latepoint-body"),"error")}})}function latepoint_remove_coupon(t){t.closest(".applied-coupon-code").fadeOut();var e=t.closest(".latepoint-booking-form-element");e.find('input[name="booking[coupon_code]"]').val(""),latepoint_reload_step(e)}function latepoint_reload_step(t,e){var a=arguments.length>1&&void 0!==e&&e;return a&&(t.find(".latepoint_current_step").val(a),t.removeClass((function(t,e){return(e.match(/(^|\s)current-step-\S+/g)||[]).join(" ")})).addClass("current-step-"+a),t.find('.latepoint-step-content[data-step-name="'+a+'"]')&&(t.find('.latepoint-step-content[data-step-name="'+a+'"]').nextAll(".latepoint-step-content").remove(),t.find('.latepoint-step-content[data-step-name="'+a+'"]').remove())),t.find(".latepoint_step_direction").val("specific"),t.find(".latepoint-form").submit(),!1}function latepoint_get_payment_sub_step(t,e,a){var n=arguments.length>2&&void 0!==a&&a,s=n?-1:1,o=[];t.find(".step-payment-w .lp-payment-times-w").length&&o.push("payment-times"),t.find(".step-payment-w .lp-payment-methods-w").length&&o.push("payment-methods"),t.find(".step-payment-w .lp-payment-portions-w").length&&o.push("payment-portions");var i=t.find('input[name="booking[payment_method]"]').val();i&&o.push("payment-method-content");var l=o.indexOf(e)+s;if(l>=0&&l<o.length){var r=o[l];return"payment-method-content"==r&&(latepoint_init_payment_method_actions(t,i),t.find('.lp-payment-method-content[data-payment-method="'+i+'"]').length||(r=e)),r}return e}function latepoint_reset_password_from_booking_init(){jQuery(".os-step-existing-customer-login-w").hide(),jQuery(".os-password-reset-form-holder").on("click",".password-reset-back-to-login",(function(){return jQuery(".os-password-reset-form-holder").html(""),jQuery(".os-step-existing-customer-login-w").show(),!1}))}function latepoint_update_summary_field(t,e,a){var n=arguments.length>2&&void 0!==a?a:"",s=t.closest(".latepoint-with-summary");s.length&&((n=!!n&&String(n).trim())?(t.find(".os-summary-value-"+e).html(n).closest(".os-summary-line").addClass("os-has-value"),s.hasClass("latepoint-summary-is-open")?t.find(".os-summary-line.os-has-value").slideDown(150):t.find(".os-summary-line.os-has-value").fadeIn(200),s.addClass("latepoint-summary-is-open")):t.find(".os-summary-value-"+e).text("").closest(".os-summary-line").slideUp(150).removeClass("os-has-value"))}function latepoint_password_changed_show_login(t){jQuery(".os-step-existing-customer-login-w").show(),jQuery(".os-password-reset-form-holder").html(""),latepoint_show_message_inside_element(t.message,jQuery(".os-step-existing-customer-login-w"),"success")}function latepoint_hide_message_inside_element(t){var e=arguments.length>0&&void 0!==t?t:jQuery(".latepoint-body");e.length&&e.find(".latepoint-message").length&&e.find(".latepoint-message").remove()}function latepoint_show_message_inside_element(t,e,a){var n=arguments.length>1&&void 0!==e?e:jQuery(".latepoint-body"),s=arguments.length>2&&void 0!==a?a:"error";n.length&&(n.find(".latepoint-message").length?n.find(".latepoint-message").removeClass("latepoint-message-success").removeClass("latepoint-message-error").addClass("latepoint-message-"+s).html(t).show():n.prepend('<div class="latepoint-message latepoint-message-'+s+'">'+t+"</div>"))}function latepoint_add_action(t,e,a){var n=arguments.length>2&&void 0!==a?a:10;return t.push({priority:n,action:e}),t.sort((function(t,e){return t.priority-e.priority})),t}jQuery(document).ready((function(t){t(".latepoint").on("click","button[data-os-action], a[data-os-action], div[data-os-action], span[data-os-action]",(function(e){var a=t(this);if(a.data("os-prompt")&&!confirm(a.data("os-prompt")))return!1;var n=t(this).data("os-params");t(this).data("os-source-of-params")&&(n=t(t(this).data("os-source-of-params")).find("select, input, textarea").serialize());var s=a.data("os-return-format")?a.data("os-return-format"):"json",o={action:"latepoint_route_call",route_name:t(this).data("os-action"),params:n,return_format:s};return a.addClass("os-loading"),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function e(n){if("success"===n.status){if("lightbox"==a.data("os-output-target"))latepoint_show_data_in_lightbox(n.message,a.data("os-lightbox-classes"));else if("side-panel"==a.data("os-output-target"))t(".latepoint-side-panel-w").remove(),t("body").append('<div class="latepoint-side-panel-w"><div class="latepoint-side-panel-i">'+n.message+'</div><div class="latepoint-side-panel-shadow"></div></div>');else{if("reload"==a.data("os-success-action"))return latepoint_add_notification(n.message),void location.reload();if("redirect"==a.data("os-success-action"))return void(a.data("os-redirect-to")?(latepoint_add_notification(n.message),window.location.replace(a.data("os-redirect-to"))):window.location.replace(n.message));a.data("os-output-target")&&t(a.data("os-output-target")).length?"append"==a.data("os-output-target-do")?t(a.data("os-output-target")).append(n.message):t(a.data("os-output-target")).html(n.message):"before"==a.data("os-before-after")?a.before(n.message):"before"==a.data("os-before-after")?a.after(n.message):latepoint_add_notification(n.message)}if(a.data("os-after-call")){var s=a.data("os-after-call");a.data("os-pass-this")?window[s](a):a.data("os-pass-response")?window[s](n):window[s]()}a.removeClass("os-loading")}else a.removeClass("os-loading"),a.data("os-output-target")&&t(a.data("os-output-target")).length?t(a.data("os-output-target")).prepend(latepoint_generate_form_message_html(n.message,"error")):alert(n.message)}}),!1})),t(".latepoint").on("click",'form[data-os-action] button[type="submit"]',(function(e){t(this).addClass("os-loading")})),t(".latepoint").on("submit","form[data-os-action]",(function(e){e.preventDefault();var a=t(this),n=a.serialize(),s={action:"latepoint_route_call",route_name:t(this).data("os-action"),params:n,return_format:"json"};return a.find('button[type="submit"]').addClass("os-loading"),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:s,success:function e(n){if(a.find('button[type="submit"].os-loading').removeClass("os-loading"),latepoint_clear_form_messages(a),"success"===n.status){if("reload"==a.data("os-success-action"))return latepoint_add_notification(n.message),void location.reload();if("redirect"==a.data("os-success-action"))return void(a.data("os-redirect-to")?(latepoint_add_notification(n.message),window.location.replace(a.data("os-redirect-to"))):window.location.replace(n.message));if(a.data("os-output-target")&&t(a.data("os-output-target")).length?t(a.data("os-output-target")).html(n.message):"redirect"==n.message?window.location.replace(n.url):(latepoint_add_notification(n.message),a.prepend(latepoint_generate_form_message_html(n.message,"success"))),a.data("os-record-id-holder")&&n.record_id&&a.find('[name="'+a.data("os-record-id-holder")+'"]').val(n.record_id),a.data("os-after-call")){var s=a.data("os-after-call");a.data("os-pass-response")?window[s](n):window[s]()}t("button.os-loading").removeClass("os-loading")}else t("button.os-loading").removeClass("os-loading"),a.data("os-show-errors-as-notification")?latepoint_add_notification(n.message,"error"):(a.prepend(latepoint_generate_form_message_html(n.message,"error")),t([document.documentElement,document.body]).animate({scrollTop:a.find(".os-form-message-w").offset().top-30},200));n.form_values_to_update&&t.each(n.form_values_to_update,(function(t,e){a.find('[name="'+t+'"]').val(e)}))}}),!1}))})),function(t){function e(t,e){switch(c(),t){case"datepicker":r();break;case"contact":x();break;case"agents":y();break;case"locations":break;case"services":g();break;case"payment":p(e);break;case"verify":d(e);break;case"confirmation":w();break}e.trigger("latepoint:initStep",[{step_name:t}]),e.trigger("latepoint:initStep:"+t)}function a(e){var a=e.closest(".latepoint-booking-form-element");e.addClass("selected");var n=e.data("service-duration"),s=e.data("interval"),o=e.data("work-start-time"),i=e.data("work-end-time"),l=e.data("total-work-minutes"),r=!!e.attr("data-available-minutes")&&e.data("available-minutes").toString().split(",").map(Number),d=e.data("day-minutes").toString().split(",").map(Number),p=a.find(".timeslots");if(p.html(""),l>0&&r.length&&d.length){var c=!1;d.forEach((function(t){if(!(t+n>i)){var e=latepoint_am_or_pm(t),a="dp-timepicker-trigger";if("timeline"==latepoint_helper.time_pick_style?a+=" dp-timeslot":a+=" dp-timebox",!1!==c&&t-c>n){var o=latepoint_minutes_to_hours_and_minutes(c+n)+" "+latepoint_am_or_pm(c+n)+" - "+latepoint_minutes_to_hours_and_minutes(t)+" "+latepoint_am_or_pm(t),d=(t-c-n)/(l+n)*100;p.append('<div class="'+a+' is-off" style="max-width:'+d+"%; width:"+d+'%"><span class="dp-label">'+o+"</span></div>")}r.includes(t)||(a+=" is-booked");var m="";(t%60==0||s>=60)&&(a+=" with-tick",m='<span class="dp-tick"><strong>'+latepoint_minutes_to_hours_preferably(t)+"</strong> "+e+"</span>");var u=latepoint_minutes_to_hours_and_minutes(t)+" "+e;if(latepoint_show_booking_end_time()){var _=t+n,f=latepoint_am_or_pm(_);u+=' - <span class="dp-label-end-time">'+latepoint_minutes_to_hours_and_minutes(_)+" "+f+"</span>"}u=u.trim(),p.removeClass("slots-not-available").append('<div class="'+a+'" data-minutes="'+t+'"><span class="dp-label">'+u+"</span>"+m+"</div>"),c=t}}))}else p.addClass("slots-not-available").append('<div class="not-working-message">'+latepoint_helper.msg_not_available+"</div>");t(".times-header-label span").text(e.data("nice-date")),a.find(".time-selector-w").slideDown(200,(function(){var t=a.find(".latepoint-body");t.stop().animate({scrollTop:t[0].scrollHeight},200)}))}function n(){t(".dp-timepicker-trigger").on("click",(function(){var e=t(this).closest(".latepoint-booking-form-element");if(t(this).hasClass("is-booked")||t(this).hasClass("is-off"));else if(t(this).hasClass("selected"))t(this).removeClass("selected"),t(this).find(".dp-success-label").remove(),e.find(".latepoint_start_time").val(""),latepoint_hide_next_btn(e),latepoint_update_summary_field(e,"time","");else{e.find(".dp-timepicker-trigger.selected").removeClass("selected").find(".dp-success-label").remove();var a=t(this).find(".dp-label").html();t(this).addClass("selected").find(".dp-label").html('<span class="dp-success-label">'+e.find(".latepoint-form").data("selected-label")+"</span>"+a),e.find(".latepoint_start_time").val(t(this).data("minutes")),latepoint_show_next_btn(e),latepoint_update_summary_field(e,"time",a)}return!1}))}function s(){t(".os-month-next-btn").on("click",(function(){var e=t(this).closest(".latepoint-booking-form-element"),a=t(this).data("route");if(e.find(".os-monthly-calendar-days-w.active + .os-monthly-calendar-days-w").length)e.find(".os-monthly-calendar-days-w.active").removeClass("active").next(".os-monthly-calendar-days-w").addClass("active"),o(e);else if(1){var n=t(this);n.addClass("os-loading");var s=e.find(".os-monthly-calendar-days-w").last(),l=s.data("calendar-year"),r=s.data("calendar-month");12==r?(l+=1,r=1):r+=1;var d,p={action:"latepoint_route_call",route_name:a,params:{target_date_string:l+"-"+r+"-1",location_id:e.find(".latepoint_location_id").val(),agent_id:e.find(".latepoint_agent_id").val(),service_id:e.find(".latepoint_service_id").val(),duration:e.find('input[name="booking[duration]"]').val(),total_attendies:e.find('input[name="booking[total_attendies]"]').val()},layout:"none",return_format:"json"};t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:p,success:function t(a){n.removeClass("os-loading"),"success"===a.status&&(e.find(".os-months").append(a.message),e.find(".os-monthly-calendar-days-w.active").removeClass("active").next(".os-monthly-calendar-days-w").addClass("active"),o(e))}})}return i(e),!1})),t(".os-month-prev-btn").on("click",(function(){var e=t(this).closest(".latepoint-booking-form-element");return e.find(".os-monthly-calendar-days-w.active").prev(".os-monthly-calendar-days-w").length&&(e.find(".os-monthly-calendar-days-w.active").removeClass("active").prev(".os-monthly-calendar-days-w").addClass("active"),o(e)),i(e),!1}))}function o(t){t.find(".os-current-month-label .current-year").text(t.find(".os-monthly-calendar-days-w.active").data("calendar-year")),t.find(".os-current-month-label .current-month").text(t.find(".os-monthly-calendar-days-w.active").data("calendar-month-label"))}function i(t){t.find(".os-current-month-label .current-year").text(t.find(".os-monthly-calendar-days-w.active .os-monthly-calendar-days").data("calendar-year")),t.find(".os-current-month-label .current-month").text(t.find(".os-monthly-calendar-days-w.active .os-monthly-calendar-days").data("calendar-month-label")),t.find(".os-monthly-calendar-days-w.active").prev(".os-monthly-calendar-days-w").length?t.find(".os-month-prev-btn").removeClass("disabled"):t.find(".os-month-prev-btn").addClass("disabled")}function l(t,e){var a=latepoint_am_or_pm(t),n=latepoint_minutes_to_hours_and_minutes(t)+" "+a;if(latepoint_show_booking_end_time()){var s=t+e,o=latepoint_am_or_pm(s);n+=" - "+latepoint_minutes_to_hours_and_minutes(s)+" "+o}return n=n.trim()}function r(){n(),s(),t(".os-months").on("click",".os-day",(function(){if(t(this).hasClass("os-day-passed"))return!1;if(t(this).hasClass("os-not-in-allowed-period"))return!1;var e=t(this).closest(".latepoint-booking-form-element");if(t(this).closest(".os-monthly-calendar-days-w").hasClass("hide-if-single-slot"))if(t(this).hasClass("os-not-available"));else if(e.find(".os-day.selected").removeClass("selected"),t(this).addClass("selected"),e.find(".latepoint_start_date").val(t(this).data("date")),latepoint_update_summary_field(e,"date",t(this).data("nice-date")),t(this).hasClass("os-one-slot-only")){var s=l(t(this).data("available-minutes"),t(this).data("service-duration"));e.find(".latepoint_start_time").val(t(this).data("available-minutes")),latepoint_show_next_btn(e),latepoint_update_summary_field(e,"time",s)}else a(t(this)),n(),e.find(".latepoint_start_time").val(""),latepoint_hide_next_btn(e);else e.find(".latepoint_start_date").val(t(this).data("date")),latepoint_update_summary_field(e,"date",t(this).data("nice-date")),e.find(".os-day.selected").removeClass("selected"),t(this).addClass("selected"),a(t(this)),n(),latepoint_update_summary_field(e,"time",""),e.find(".latepoint_start_time").val(""),latepoint_hide_next_btn(e);return!1}))}function d(t){var e=arguments.length>0&&void 0!==t&&t;e&&e.closest(".latepoint-summary-is-open").removeClass("latepoint-summary-is-open")}function p(e){var a=arguments.length>0&&void 0!==e&&e;a.find(".step-payment-w").data("full-amount")>0&&latepoint_update_summary_field(a,"price",h((100*a.find(".step-payment-w").data("full-amount")/100).toFixed(2))),a&&"deposit"==a.find(".step-payment-w").data("default-portion")&&a.find('input[name="booking[payment_portion]"]').val("deposit");var n=a.find('input[name="booking[payment_method]"]').val();!n||t(".lp-payment-times-w").length||t(".lp-payment-methods-w").length||t(".lp-payment-portions-w").length||latepoint_init_payment_method_actions(a,n),t(".latepoint-booking-form-element .coupon-code-input-submit").on("click",(function(e){return latepoint_apply_coupon(t(this).closest(".coupon-code-input-w").find(".coupon-code-input")),!1})),t(".latepoint-booking-form-element .coupon-code-clear").on("click",(function(e){return latepoint_remove_coupon(t(this)),!1})),t(".latepoint-booking-form-element input.coupon-code-input").on("keyup",(function(e){if(13===e.which)return latepoint_apply_coupon(t(this)),!1})),t(".latepoint-booking-form-element .coupon-code-trigger-w a").on("click",(function(e){return t(this).closest(".payment-total-info").addClass("entering-coupon").find(".coupon-code-input").focus(),!1})),t(".latepoint-booking-form-element .lp-payment-trigger-later").on("click",(function(e){var a=t(this).closest(".latepoint-booking-form-element");a.find('input[name="booking[payment_method]"]').val(t(this).data("method")),a.find('input[name="booking[payment_portion]"]').val(""),a.find(".latepoint-form").submit()})),t(".latepoint-booking-form-element .lp-payment-trigger-payment-time-selector").on("click",(function(e){var a=t(this).closest(".latepoint-booking-form-element"),n=a.find(".step-payment-w");return latepoint_hide_next_btn(a),latepoint_show_prev_btn(a),n.attr("data-sub-step",latepoint_get_payment_sub_step(a,n.attr("data-sub-step"))),!1})),t(".latepoint-booking-form-element .lp-payment-trigger-payment-method-selector").on("click",(function(e){var a=t(this).closest(".latepoint-booking-form-element"),n=t(this).data("method");a.find('input[name="booking[payment_method]"]').val(n);var s=a.find(".step-payment-w");latepoint_hide_next_btn(a),latepoint_show_prev_btn(a),s.attr("data-sub-step",latepoint_get_payment_sub_step(a,s.attr("data-sub-step")))})),t(".latepoint-booking-form-element .lp-payment-trigger-payment-portion-selector").on("click",(function(e){var a=t(this).closest(".latepoint-booking-form-element"),n=jQuery(this).data("portion");a.find('input[name="booking[payment_portion]"]').val(n),"deposit"==n?a.find(".payment-total-info").addClass("paying-deposit"):a.find(".payment-total-info").removeClass("paying-deposit");var s=a.find(".step-payment-w");latepoint_hide_next_btn(a),latepoint_show_prev_btn(a),s.attr("data-sub-step",latepoint_get_payment_sub_step(a,s.attr("data-sub-step")))}))}function c(){t(".os-selectable-items .os-selectable-item").off("click",f),t(".os-selectable-items .os-selectable-item").on("click",f),t(".os-selectable-items .os-selectable-item .item-quantity-selector-input").off("keyup",_),t(".os-selectable-items .os-selectable-item .item-quantity-selector-input").on("keyup",_)}function m(e){e.find(".os-summary-value.os-summary-value-price").addClass("os-loading");var a,n=e.find(".latepoint-form").serialize(),s={action:"latepoint_route_call",route_name:latepoint_helper.calculate_price_route,params:n,layout:"none",return_format:"json"};t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:s,success:function t(a){"success"===a.status&&(latepoint_update_summary_field(e,"price",a.price),e.find(".os-summary-value.os-summary-value-price").removeClass("os-loading"))}})}function u(e){var a=e.closest(".os-selectable-items").find(".os-selectable-item.selected").map((function(){return t(this).hasClass("has-quantity")?t(this).data("item-id")+":"+t(this).find("input.item-quantity-selector-input").val():t(this).data("item-id")})).get();e.closest(".latepoint-booking-form-element").find(e.data("id-holder")).val(a)}function _(e){var a=t(this).closest(".latepoint-booking-form-element"),n=t(this).closest(".os-selectable-item"),s=t(this).val();if(s&&s.match(/^\d+$/)){var o=n.data("max-quantity");o&&s>o&&(s=o)}else s=0;if(t(this).val(s),n.hasClass("selected")&&s>0||!n.hasClass("selected")&&0==s)return u(n),m(a),!1;n.trigger("click")}function f(e){e.stopPropagation(),e.stopImmediatePropagation();var a=t(this).closest(".latepoint-booking-form-element");if(t(this).hasClass("has-quantity")){if(t(e.target).hasClass("item-quantity-selector")){var n=parseInt(t(this).find("input.item-quantity-selector-input").val()),s="minus"==t(e.target).data("sign")?n-1:n+1,o=t(this).data("max-quantity");if(s<0&&(s=0),o&&s>o&&(s=o),t(this).find("input.item-quantity-selector-input").val(s),t(this).hasClass("selected")&&s>0||!t(this).hasClass("selected")&&0==s)return u(t(this)),m(a),!1}if(t(e.target).hasClass("item-quantity-selector-input"))return u(t(this)),m(a),!1}var i="";t(this).hasClass("os-allow-multiselect")?(t(this).hasClass("selected")?(t(this).removeClass("selected"),t(this).hasClass("has-quantity")&&t(this).find("input.item-quantity-selector-input").val(0)):(t(this).addClass("selected"),!t(this).hasClass("has-quantity")||t(this).find("input.item-quantity-selector-input").val()>0||t(this).find("input.item-quantity-selector-input").val(1)),u(t(this)),i=String(t(this).closest(".os-selectable-items").find(".os-selectable-item.selected").map((function(){return" "+t(this).data("summary-value")})).get()).trim(),latepoint_show_next_btn(a)):(t(this).hasClass("os-duration-item")||t(this).closest(".os-service-categories-main-parent").find(".os-selectable-item.selected").removeClass("selected"),t(this).closest(".os-selectable-items").find(".os-selectable-item.selected").removeClass("selected"),t(this).addClass("selected"),a.find(t(this).data("id-holder")).val(t(this).data("item-id")),i=t(this).data("summary-value"),t(this).data("os-call-func")&&window[t(this).data("os-call-func")](t(this)),t(this).data("activate-sub-step")?window[t(this).data("activate-sub-step")](t(this)):v(a)),latepoint_update_summary_field(a,t(this).data("summary-field-name"),i),t(this).hasClass("os-priced-item")&&m(a)}function h(t){return latepoint_helper.currency_symbol_before+String(t)+latepoint_helper.currency_symbol_after}function g(){t(".total-attendies-selector-input").on("change",(function(){var e=t(this).closest(".total-attendies-selector-w").data("max-capacity"),a=t(this).closest(".total-attendies-selector-w").data("min-capacity"),n=t(this).val();n=Math.min(Number(e),Number(n)),n=Math.max(Number(a),Number(n)),t(this).val(n);var s=t(this).closest(".latepoint-booking-form-element");latepoint_update_summary_field(s,"total-attendies",n),m(s)})),t(".total-attendies-selector").on("click",(function(){var e=t(this).hasClass("total-attendies-selector-plus")?1:-1,a=t(this).closest(".total-attendies-selector-w").data("max-capacity"),n=t(this).closest(".total-attendies-selector-w").data("min-capacity"),s=t(this).closest(".total-attendies-selector-w").find("input.total-attendies-selector-input").val(),o=Number(s)>0?Math.max(Number(s)+e,1):1;return o=Math.min(Number(a),o),o=Math.max(Number(n),o),t(this).closest(".total-attendies-selector-w").find("input").val(o).trigger("change"),!1})),t(".os-service-category-info").on("click",(function(){var e;latepoint_show_prev_btn(t(this).closest(".latepoint-booking-form-element")),t(this).closest(".step-services-w").addClass("selecting-service-category");var a=t(this).closest(".os-service-category-w"),n=t(this).closest(".os-service-categories-main-parent");return a.hasClass("selected")?(a.removeClass("selected"),a.parent().closest(".os-service-category-w").length?a.parent().closest(".os-service-category-w").addClass("selected"):n.removeClass("show-selected-only")):(n.find(".os-service-category-w.selected").removeClass("selected"),n.addClass("show-selected-only"),a.addClass("selected")),!1}))}function v(t){t.find(".latepoint_step_direction").val("next"),t.find(".latepoint-form").submit()}function b(){}function y(){t(".os-items .os-item-details-btn").on("click",(function(){var e=t(this).closest(".latepoint-booking-form-element"),a=t(this).data("agent-id");return e.find(".os-agent-bio-popup.active").removeClass("active"),e.find("#osAgentBioPopup"+a).addClass("active"),!1})),t(".os-agent-bio-close").on("click",(function(){return t(this).closest(".os-agent-bio-popup").removeClass("active"),!1}))}function w(){t(".latepoint-booking-form-element").on("click",".set-customer-password-btn",(function(){var e=t(this),a=t(this).closest(".latepoint-booking-form-element");e.addClass("os-loading");var n={account_nonse:t('input[name="account_nonse"]').val(),password:t('input[name="customer[password]"]').val(),password_confirmation:t('input[name="customer[password_confirmation]"]').val()},s={action:"latepoint_route_call",route_name:t(this).data("btn-action"),params:t.param(n),layout:"none",return_format:"json"};return t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:s,success:function t(n){e.removeClass("os-loading"),"success"===n.status?(a.find(".step-confirmation-set-password").html("").hide(),a.find(".confirmation-cabinet-info").show()):latepoint_show_message_inside_element(n.message,a.find(".step-confirmation-set-password"),"error")}}),!1})),t(".latepoint-booking-form-element").on("click",".qr-show-trigger",(function(){var e;return t(this).closest(".latepoint-booking-form-element").find(".qr-code-on-confirmation").addClass("show-vevent-qr-code"),!1})),
t(".latepoint-booking-form-element").on("click",".show-set-password-fields",(function(){var e=t(this).closest(".latepoint-booking-form-element");return e.find(".step-confirmation-set-password").show(),e.find("#customer_password").focus(),t(this).closest(".info-box").hide(),!1}))}function C(){if(t(".latepoint-login-form-w #facebook-signin-btn").length&&t(".latepoint-login-form-w").length&&t(".latepoint-login-form-w #facebook-signin-btn").on("click",(function(){var e=t(this).closest(".latepoint-login-form-w");FB.login((function(a){if("connected"===a.status&&a.authResponse){var n={token:a.authResponse.accessToken},s={action:"latepoint_route_call",route_name:e.find("#facebook-signin-btn").data("login-action"),params:t.param(n),layout:"none",return_format:"json"};j(e),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:s,success:function t(a){"success"===a.status?location.reload():(latepoint_show_message_inside_element(a.message,e),T(!1,e))}})}}),{scope:"public_profile,email"})})),t(".latepoint-login-form-w #google-signin-btn").length&&t(".latepoint-login-form-w").length&&"undefined"!=typeof gapi){var e={},a;t(".latepoint-login-form-w").each((function(){var e=t(this);gapi.load("auth2",(function(){var a;gapi.auth2.init({client_id:e.find("meta[name=google-signin-client_id]").attr("content"),cookiepolicy:"single_host_origin"}).attachClickHandler(e.find("#google-signin-btn")[0],{},(function(a){var n={token:a.getAuthResponse().id_token},s={action:"latepoint_route_call",route_name:e.find("#google-signin-btn").data("login-action"),params:t.param(n),layout:"none",return_format:"json"};j(e),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:s,success:function t(a){"success"===a.status?location.reload():(latepoint_show_message_inside_element(a.message,e),T(!1,e))}})}),(function(t){}))}))}))}}function k(t){var e="",a=t.find('input[name="customer[first_name]"]').val(),n=t.find('input[name="customer[last_name]"]').val();return a&&(e+=a),n&&(e+=" "+n),e.trim()}function x(){A(),Q(),latepoint_init_form_masks(),t(".step-contact-w").each((function(){latepoint_update_summary_field(t(this).closest(".latepoint-booking-form-element"),"customer",k(t(this)))})),t(".step-contact-w").on("keyup",'input[name="customer[first_name]"], input[name="customer[last_name]"]',(function(){var e=t(this).closest(".latepoint-booking-form-element");latepoint_update_summary_field(e,"customer",k(e))})),t(".step-contact-w").on("keyup",".os-form-control.required",(function(){var e;N(t(this).closest(".latepoint-booking-form-element").find(".step-contact-w .os-form-control.required"))})),t(".step-customer-logout-btn").on("click",(function(){var e=t(this).closest(".latepoint-booking-form-element"),a={action:"latepoint_route_call",route_name:t(this).data("btn-action"),layout:"none",return_format:"json"};return j(e),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:a,success:function t(a){latepoint_reload_step(e)}}),!1})),t(".step-login-existing-customer-btn").on("click",(function(){var e=t(this).closest(".latepoint-booking-form-element"),a={email:e.find('.os-step-existing-customer-login-w input[name="customer_login[email]"]').val(),password:e.find('.os-step-existing-customer-login-w input[name="customer_login[password]"]').val()},n={action:"latepoint_route_call",route_name:t(this).data("btn-action"),params:t.param(a),layout:"none",return_format:"json"};return j(e),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:n,success:function t(a){"success"===a.status?latepoint_reload_step(e):(latepoint_show_message_inside_element(a.message,e.find(".os-step-existing-customer-login-w")),T(!1,e))}}),!1}))}function j(t){t.removeClass("step-content-loaded").addClass("step-content-loading")}function T(t,e){t&&e.find(".latepoint-body .latepoint-step-content").replaceWith(t),e.removeClass("step-content-loading").addClass("step-content-mid-loading"),setTimeout((function(){e.removeClass("step-content-mid-loading").addClass("step-content-loaded")}),50)}function A(){t("#facebook-signin-btn").length&&t(".latepoint-booking-form-element").length&&t("#facebook-signin-btn").on("click",(function(){var e=t(this).closest(".latepoint-booking-form-element");FB.login((function(a){if("connected"===a.status&&a.authResponse){var n={token:a.authResponse.accessToken},s={action:"latepoint_route_call",route_name:e.find("#facebook-signin-btn").data("login-action"),params:t.param(n),layout:"none",return_format:"json"};j(e),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:s,success:function t(a){"success"===a.status?latepoint_reload_step(e):(latepoint_show_message_inside_element(a.message,e.find(".os-step-existing-customer-login-w ")),T(!1,e))}})}}),{scope:"public_profile,email"})}))}function Q(){var e;t("#google-signin-btn").length&&t(".latepoint-booking-form-element").length&&"undefined"!=typeof gapi&&t(".latepoint-booking-form-element").each((function(){var e=t(this);gapi.load("auth2",(function(){var a;gapi.auth2.init({client_id:e.find("meta[name=google-signin-client_id]").attr("content"),cookiepolicy:"single_host_origin"}).attachClickHandler(e.find("#google-signin-btn")[0],{},(function(a){var n={token:a.getAuthResponse().id_token},s={action:"latepoint_route_call",route_name:e.find("#google-signin-btn").data("login-action"),params:t.param(n),layout:"none",return_format:"json"};j(e),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:s,success:function t(a){"success"===a.status?latepoint_reload_step(e):(latepoint_show_message_inside_element(a.message,e.find(".os-step-existing-customer-login-w ")),T(!1,e))}})}),(function(t){}))}))}))}function q(t,e){t.removeClass("step-changed").addClass("step-changing"),setTimeout((function(){var a=t.find('.latepoint-progress li[data-step-name="'+e+'"]');a.addClass("active").addClass("complete").prevAll().addClass("complete").removeClass("active"),a.nextAll().removeClass("complete").removeClass("active");var n=t.find('.latepoint-step-desc-library[data-step-name="'+e+'"]').html();t.find(".latepoint-step-desc").html(n);var s=t.find('.os-heading-text-library[data-step-name="'+e+'"]').html();t.find(".os-heading-text").html(s),setTimeout((function(){t.removeClass("step-changing").addClass("step-changed")}),50)}),500)}function z(t,e){var a=t.find('.latepoint-progress li[data-step-name="'+e+'"]');a.addClass("active").addClass("complete").prevAll().addClass("complete").removeClass("active"),a.nextAll().removeClass("complete").removeClass("active")}function S(t,e){var a=t.find('.latepoint-progress li[data-step-name="'+e+'"]');a.addClass("active").addClass("complete").prevAll().addClass("complete").removeClass("active"),a.nextAll().removeClass("complete").removeClass("active")}function I(t,e){t.removeClass("step-changed").addClass("step-changing"),setTimeout((function(){t.find(".latepoint-step-desc").html(t.find(".latepoint-step-desc-library.active").removeClass("active").next(".latepoint-step-desc-library").addClass("active").html()),t.find(".os-heading-text").html(t.find(".os-heading-text-library.active").removeClass("active").next(".os-heading-text-library").addClass("active").html()),setTimeout((function(){t.removeClass("step-changing").addClass("step-changed")}),50)}),500)}function M(t,e){t.removeClass("step-changed").addClass("step-changing"),setTimeout((function(){t.find(".latepoint-step-desc").html(t.find(".latepoint-step-desc-library.active").removeClass("active").prev(".latepoint-step-desc-library").addClass("active").html()),t.find(".os-heading-text").html(t.find(".os-heading-text-library.active").removeClass("active").prev(".os-heading-text-library").addClass("active").html()),setTimeout((function(){t.removeClass("step-changing").addClass("step-changed")}),50)}),500)}function N(e){var a=!0;return e.each((function(e){if(""==t(this).val())return a=!1,!1})),a}function F(a){var n=a.closest(".latepoint-booking-form-element"),s=a.serialize(),o={action:"latepoint_route_call",route_name:a.data("route-name"),params:s,layout:"none",return_format:"json"};n.removeClass("step-content-loaded").addClass("step-content-loading"),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function t(s){"success"===s.status?(latepoint_hide_message_inside_element(n.find(".latepoint-body")),n.data("flash-error")&&(latepoint_show_message_inside_element(n.data("flash-error"),n.find(".latepoint-body")),n.data("flash-error","")),n.find(".latepoint_current_step").val(s.step_name),n.removeClass((function(t,e){return(e.match(/(^|\s)current-step-\S+/g)||[]).join(" ")})).addClass("current-step-"+s.step_name),setTimeout((function(){n.removeClass("step-content-loading").addClass("step-content-mid-loading"),n.find(".latepoint-body").find(".latepoint-step-content").addClass("is-hidden"),n.find('.latepoint-step-content[data-step-name="'+s.step_name+'"]')&&n.find('.latepoint-step-content[data-step-name="'+s.step_name+'"]').remove(),n.find(".latepoint-body").append(s.message),e(s.step_name,n),setTimeout((function(){n.removeClass("step-content-mid-loading").addClass("step-content-loaded"),n.find(".latepoint-next-btn, .latepoint-prev-btn").removeClass("os-loading")}),50)}),500),s.is_pre_last_step?(n.data("next-submit-is-last","yes"),n.find(".latepoint-next-btn span").text(n.find(".latepoint-next-btn").data("pre-last-step-label"))):(n.data("next-submit-is-last","no"),n.find(".latepoint-next-btn span").text(n.find(".latepoint-next-btn").data("label"))),s.is_last_step?(n.addClass("hidden-buttons").find(".latepoint-footer").remove(),n.find(".latepoint-progress").css("opacity",0),n.closest(".latepoint-summary-is-open").removeClass("latepoint-summary-is-open"),n.addClass("is-final-step")):(!0===s.show_next_btn?latepoint_show_next_btn(n):latepoint_hide_next_btn(n),!0===s.show_prev_btn?latepoint_show_prev_btn(n):latepoint_hide_prev_btn(n)),q(n,s.step_name)):(n.removeClass("step-content-loading").addClass("step-content-loaded"),n.find(".latepoint-next-btn, .latepoint-prev-btn").removeClass("os-loading"),s.send_to_step&&n.find('.latepoint-step-content[data-step-name="'+s.send_to_step+'"]').length?(n.data("flash-error",s.message),latepoint_reload_step(n,s.send_to_step)):(latepoint_show_message_inside_element(s.message,n.find(".latepoint-body")),latepoint_show_prev_btn(n))),a.find(".latepoint_step_direction").val("next")}})}function H(){if(t(".latepoint-booking-form-element .latepoint-form").on("submit",(function(e){var a;e.preventDefault();var n=t(this),s=n.closest(".latepoint-booking-form-element");latepoint_hide_prev_btn(s);var o=s.find(".latepoint_current_step").val(),i=[];s.trigger("latepoint:submitBookingForm",[{current_step:o,callbacks_list:i,is_final_submit:"yes"==s.data("next-submit-is-last"),direction:s.find(".latepoint_step_direction").val()}]),(a=jQuery).when.apply(a,_toConsumableArray(i.map((function(t){return t.action()})))).done((function(){F(n)})).fail((function(t){t.send_to_step&&s.find('.latepoint-step-content[data-step-name="'+t.send_to_step+'"]').length&&latepoint_reload_step(s,t.send_to_step),s.removeClass("step-content-loading").addClass("step-content-loaded"),latepoint_show_message_inside_element(t.message,s.find(".latepoint-body"),"error"),s.find(".latepoint-next-btn").removeClass("os-loading"),s.find(".latepoint-step-content:last-child").prev(".latepoint-step-content").length&&latepoint_show_prev_btn(s)}))})),t(".latepoint-lightbox-close").on("click",(function(){return t("body").removeClass("latepoint-lightbox-active"),t(".latepoint-lightbox-w").remove(),!1})),t(".latepoint-customer-timezone-selector-w select").on("change",(function(e){var a=t(this);a.closest(".latepoint-customer-timezone-selector-w").addClass("os-loading");var n={action:"latepoint_route_call",route_name:t(this).closest(".latepoint-customer-timezone-selector-w").data("route-name"),params:{timezone_name:t(this).val()},layout:"none",return_format:"json"};t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:n,success:function t(e){a.closest(".latepoint-customer-timezone-selector-w").removeClass("os-loading"),"success"===e.status&&location.reload()}})})),t(".latepoint-timezone-selector-w select").on("change",(function(e){var a=t(this);a.closest(".latepoint-timezone-selector-w").addClass("os-loading");var n={action:"latepoint_route_call",route_name:t(this).closest(".latepoint-timezone-selector-w").data("route-name"),params:{timezone_name:t(this).val()},layout:"none",return_format:"json"},s=a.closest(".latepoint-booking-form-element");s.removeClass("step-content-loaded").addClass("step-content-loading"),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:n,success:function t(e){a.closest(".latepoint-timezone-selector-w").removeClass("os-loading"),s.removeClass("step-content-loading"),"success"===e.status&&a.closest(".latepoint-booking-form-element").hasClass("current-step-datepicker")&&latepoint_reload_step(a.closest(".latepoint-booking-form-element"))}})})),!latepoint_helper.is_timezone_selected){var e=Intl.DateTimeFormat().resolvedOptions().timeZone;e&&e!=t(".latepoint-timezone-selector-w select").val()&&t(".latepoint-timezone-selector-w select").val(e).change()}t(".latepoint-booking-form-element").on("click",".lp-option",(function(){t(this).closest(".lp-options").find(".lp-option.selected").removeClass("selected"),t(this).addClass("selected")})),t(".latepoint-booking-form-element .latepoint-next-btn").on("click",(function(e){var a;if(t(this).hasClass("disabled")||t(this).hasClass("os-loading"))return!1;var n=t(this);n.addClass("os-loading");var s=t(this).closest(".latepoint-form"),o=s.closest(".latepoint-booking-form-element"),i=o.find(".latepoint_current_step").val();s.find(".latepoint_step_direction").val("next");var l=[];return o.trigger("latepoint:nextStepClicked",[{current_step:i,callbacks_list:l}]),latepoint_hide_prev_btn(o),(a=jQuery).when.apply(a,_toConsumableArray(l.map((function(t){return t.action()})))).done((function(){s.submit()})).fail((function(t){latepoint_show_message_inside_element(t.message,o.find(".latepoint-body"),"error"),n.removeClass("os-loading"),o.find(".latepoint-step-content:last-child").prev(".latepoint-step-content").length&&latepoint_show_prev_btn(o)})),!1})),t(".latepoint-booking-form-element .latepoint-prev-btn").on("click",(function(e){if(t(this).hasClass("disabled")||t(this).hasClass("os-loading"))return!1;var a,n=t(this).closest(".latepoint-form").closest(".latepoint-booking-form-element"),s=n.find(".latepoint_current_step").val();if("payment"==s){var o=n.find(".step-payment-w");if(o.length){o.find(".lp-option.selected").removeClass("selected");var i=latepoint_get_payment_sub_step(n,o.attr("data-sub-step"),!0);if(i!=o.attr("data-sub-step"))return o.find(".lp-payment-method-content").hide(),o.attr("data-sub-step",i),latepoint_hide_next_btn(n),!1}}if("services"==s){var l=n.find(".step-services-w");if(l.hasClass("selecting-service-duration"))return l.removeClass("selecting-service-duration"),l.find(".os-services > .os-item.selected").removeClass("selected"),clear_sub_step_duration(n),n.find(".latepoint-step-content").length<=1&&!l.hasClass("selecting-service-category")&&latepoint_hide_prev_btn(n),m(n),!1;if(l.hasClass("selecting-total-attendies"))return l.removeClass("selecting-total-attendies"),l.find(".os-services > .os-item.selected").hasClass("has-multiple-durations")?(l.find(".os-services > .os-item.selected .os-service-durations .os-selectable-item.selected").removeClass("selected"),l.addClass("selecting-service-duration"),latepoint_hide_next_btn(n)):l.find(".os-services > .os-item.selected").removeClass("selected"),clear_sub_step_attendies(n),n.find(".latepoint-step-content").length<=1&&!l.hasClass("selecting-service-category")&&latepoint_hide_prev_btn(n),m(n),!1;if(l.hasClass("selecting-service-category"))return l.find(".os-service-category-w .os-service-category-w.selected").length?l.find(".os-service-category-w .os-service-category-w.selected").parents(".os-service-category-w").addClass("selected").find(".os-service-category-w.selected").removeClass("selected"):(l.removeClass("selecting-service-category").find(".os-service-category-w.selected").removeClass("selected"),l.removeClass("selecting-service-category").find(".os-service-categories-holder.show-selected-only").removeClass("show-selected-only")),n.find(".latepoint-step-content").length<=1&&!l.hasClass("selecting-service-category")&&latepoint_hide_prev_btn(n),m(n),!1}var r=n.find(".latepoint-step-content:last-child");r.data("clear-action")&&window[r.data("clear-action")](n);var d=t(this);d.addClass("os-loading"),n.removeClass("step-content-loaded").addClass("step-content-loading");var p=n.find(".latepoint-step-content.is-hidden").last(),c=p.data("step-name");return q(n,c),setTimeout((function(){if(p.removeClass("is-hidden"),r.remove(),n.find(".latepoint_current_step").val(c),n.find(".latepoint-next-btn span").text(n.find(".latepoint-next-btn").data("label")),n.data("next-submit-is-last","no"),latepoint_show_next_btn(n),d.removeClass("os-loading"),n.find(".latepoint-step-content").length<=1)if("services"==c){var t=n.find(".step-services-w");t.hasClass("selecting-service-duration")||t.hasClass("selecting-total-attendies")||t.hasClass("selecting-service-category")?t.find(".os-services > .os-item.selected").hasClass("is-preselected")?t.hasClass("selecting-total-attendies")&&t.find(".os-services > .os-item.selected").hasClass("has-multiple-durations")?latepoint_show_prev_btn(n):latepoint_hide_prev_btn(n):latepoint_show_prev_btn(n):latepoint_hide_prev_btn(n)}else latepoint_hide_prev_btn(n);n.removeClass("step-content-loading").addClass("step-content-mid-loading"),setTimeout((function(){n.removeClass("step-content-mid-loading").addClass("step-content-loaded"),latepoint_hide_message_inside_element(n.find(".latepoint-body")),m(n)}),150)}),700),!1}))}t((function(){C(),t(".latepoint-booking-form-element").length&&(H(),t(".latepoint-booking-form-element").each((function(){e(t(this).find(".latepoint_current_step").val(),t(this))}))),t(".latepoint-request-booking-cancellation").on("click",(function(){if(!confirm(latepoint_helper.cancel_booking_prompt))return!1;var e=t(this),a=e.closest(".customer-booking"),n,s,o={action:"latepoint_route_call",route_name:t(this).data("route"),params:{id:a.data("id")},layout:"none",return_format:"json"};return e.addClass("os-loading"),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:o,success:function t(a){"success"===a.status?(location.reload(),e.remove()):e.removeClass("os-loading")}}),!1})),t("body").on("click",".os-step-tabs .os-step-tab",(function(){t(this).closest(".os-step-tabs").find(".os-step-tab").removeClass("active"),t(this).addClass("active");var e=t(this).data("target");t(this).closest(".os-step-tabs-w").find(".os-step-tab-content").hide(),t(e).show()})),t("body").on("keyup",".os-form-group .os-form-control",(function(){t(this).val()?t(this).closest(".os-form-group").addClass("has-value"):t(this).closest(".os-form-group").removeClass("has-value")})),t(".latepoint-tab-triggers").on("click",".latepoint-tab-trigger",(function(){var e=t(this).closest(".latepoint-tabs-w");return e.find(".latepoint-tab-trigger.active").removeClass("active"),e.find(".latepoint-tab-content").removeClass("active"),t(this).addClass("active"),e.find(".latepoint-tab-content"+t(this).data("tab-target")).addClass("active"),!1})),t(".latepoint-book-button, .os_trigger_booking").on("click",(function(){var a=t(this),n=a.closest(".latepoint-booking-form-element"),s=latepoint_helper.booking_button_route,o={},i={};a.data("show-service-categories")&&(i.show_service_categories=a.data("show-service-categories")),a.data("show-locations")&&(i.show_locations=a.data("show-locations")),a.data("show-services")&&(i.show_services=a.data("show-services")),a.data("show-agents")&&(i.show_agents=a.data("show-agents")),a.data("selected-location")&&(i.selected_location=a.data("selected-location")),a.data("selected-agent")&&(i.selected_agent=a.data("selected-agent")),a.data("selected-service")&&(i.selected_service=a.data("selected-service")),a.data("selected-service-category")&&(i.selected_service_category=a.data("selected-service-category")),a.data("selected-start-date")&&(i.selected_start_date=a.data("selected-start-date")),a.data("selected-start-time")&&(i.selected_start_time=a.data("selected-start-time")),a.data("calendar-start-date")&&(i.calendar_start_date=a.data("calendar-start-date")),0==t.isEmptyObject(i)&&(o.restrictions=i);var l={action:"latepoint_route_call",route_name:s,params:o,layout:"none",return_format:"json"};return a.addClass("os-loading"),t.ajax({type:"post",dataType:"json",url:latepoint_helper.ajaxurl,data:l,success:function s(o){if("success"===o.status){var i="";"yes"!=a.data("hide-summary")&&(i+=" latepoint-with-summary"),"yes"==a.data("hide-side-panel")&&(i+=" latepoint-hide-side-panel"),latepoint_show_data_in_lightbox(o.message,i),H(),e(o.step,n),t("body").addClass("latepoint-lightbox-active"),a.removeClass("os-loading")}else a.removeClass("os-loading")}}),!1}))}))}(jQuery);
//# sourceMappingURL=main_front.js.map